{"version":3,"sources":["scripts/app.js"],"names":["angular","module","UnitDestroyController","$uibModalInstance","vm","this","ok","close","cancel","dismiss","$inject","controller","CategoryController","models","exerciseShow","ExerciseController","$state","units","$q","$scope","$uibModal","$timeout","data","availableOptions","id","name","setLoading","res","loading","resolve","unsetLoading","uploadImageTipFile","$file","form","image_tip","exercise_tips_image_filename","submitImageTip","exercise_tips_image_url","uploadImageTipExercise","filename","type","then","uploadFileS3","upload_url","model","submit","exercise_type","exercise_type_temp","exercise_text_text_items","exercise_image_text_items","exercise_text","copy","uploadPromises","forEach","item","item_temp","item_number","image_url","image_filename","image","file","text_en","promise","createExerciseImage","exercise_image_text_item","push","all","updateExercise","exercise","flag","currentsection","value","key","element","currenttab","tab","destroy","open","templateUrl","controllerAs","windowClass","result","destroyExercise","splice","section","removeClass","addClass","tabinfo","$watch","newVal","oldVal","directive","restrict","bindToController","scope","ExerciseDestroyController","UnitController","$stateParams","show","getSectionA","unit","unit_section_a","getSectionB","unit_section_b","getSectionC","unit_section_c","getSectionD","unit_section_d","getSectionE","unit_section_e","ProfileController","LoginController","users","galoreApi","errorManager","user","login","go","DashboardController","FaqController","CreateUnitController","RangeFilter","input","min","max","parseInt","i","filter","AdminController","factory","idCount","utils","nextId","findFirst","array","length","findFirstByName","removeFirst","found","sortByOrder","isArray","sort","a","b","order","mergeOrPush","elem","added","merge","UploadFileLink","el","bind","event","files","target","$apply","link","uiState","toggleSwitch","ToggleSwitchController","publish","publishUnit","published","unpublish","unpublishUnit","tabVideo","TabVideoController","uploadVideoFile","video","video_filename","video_tips_image_filename","tabTheoryInDepth","tabTheory","TabTheoryController","image_tip_theory","tabInfoSection","tabDialogue","TabDialogueController","dialogue_tips_image_filename","uploadAudioFile","$files","files_audio","removeFile","index","audio_items","_destroy","audio_items_temp","dynamicPopover","showOnHover","linkFunc","visible","showAnimate","updateVisibility","hover","sectionUnit","SectionUnitController","$http","update","destroyUnit","animationsEnabled","current_unit","sectionE","SectionEController","activeTabIndex","tabs","updateSection","getExercises","isCollapsed","current_unit_sections_e_exercises","exercises","sectionD","SectionDController","submitUpload","video_url","uploadVideo","video_tips_image_url","uploadImageTip","submitImageTheoryTip","theory_text_tips_image_url","theory_text_tips_image_filename","submitSection","removeVideo","sectionC","SectionCController","counterC","current_unit_sections_c_exercises","sectionB","SectionBController","changeStatusSection","createFilesAudio","audio_url","audio","createFileAudio","audio_item","audio_filename","file_name","uploadFileAudio","dialogue_tips_image_url","sectionA","SectionAController","video_tips_filename","longTermMemory","$log","apiUrl","resPipe","parseResponse","helpers","validModels","_model","injectDefaults","fetchModel","forEachModel","injectProjectDefaults","injectUserDefaults","markReload","m","_reload","markDestroyed","_destroyed","removeUnitFromLevels","unitId","levelId","levels","curUnit","sortFramesAndComments","project","sortFramesAndCommentsSingle","sortFramesCache","getRelatedProject","frames","sortCommentsCache","frame","getRelatedFrame","comments","updateCache","level","updateModelCache","getRelatedLevel","current_unit_section_a","current_unit_section_b","current_unit_section_c","current_unit_section_d","current_unit_section_e","current_unit_sections_d_exercises","current_exercise","cleanCache","current_user","pruneProjectCache","projects","ids","newCache","indexOf","owner","forcePruneProjectCache","removeFromCache","removeProjectFileFromCache","setProjectAsMine","setProjectAsMineSingle","updateCurrent","humanize","humanizeProject","memorizeCache","v","k","memorize","sideEffects","side_effects","project_files","warn","log","info","debugger","_project_id","level_id","_frame_id","func","download_url","privateString","modelCache","newData","merged","val","localStorage","toJson","remember","fromJson","e","forget","oblivion","clear","Upload","counter","galoreUploader","total","upload","displayName","fileSize","obj","uploadId","status","size","updateTotal","response","err","error","reject","evt","loaded","percentage","newFiles","processing","uploading","canceled","success","queued","galoreUploaderDirective","expanded","uploader","galoreSidebar","SidebarController","state","addUnit","unit_code","sub_unit_code","sortUnits","keyA","keyB","newUnit","title","create","checkCurrentUnit","checkCurrentLevel","checkDashboard","current","SidebarLink","window","trigger","replace","galoreHeader","HeaderController","sidebar_mini","changeLevelsIcon","isCollapse","HeaderLink","galoreFooter","FooterController","FooterLink","$auth","unitApiUrl","showLevelsApiUrl","sectionApiUrl","exercisesApiUrl","cache","cacheOrHttp","method","url","headers","keep","absUrl","config","toUpperCase","uploadFileS3http","file_type","Content-Type","if-modified-since","undefined","expect200","expect201","expect204","galoreoApi","submitLogin","getMe","logout","signOut","changePassword","updatePassword","createUnit","deleteFileAudio","file_id","createExercise","id_exercise","section_id","showUnit","indexLevels","updateUnit","uploadFile","exercise_id","exercise_item_id","audio_id","type_of_tip","exerciseTextText","exerciseTextTextController","addRow","newRow","exercise_text_text_item","text_it","idEx","exerciseImageText","exerciseImageTextController","uploadImageFile","changeImageFile","row","idex","TabExerciseController","selectedOption","unit_section_id","unit_section_type","exercise_text_text","exercise_image_text","exercise_tips","subtitle","toastr","isObject","getErrorString","isString","full_messages","error_description","errors","msg","myErr","join","reset","ckeditorStandard","CkEditorStandardController","options","language","allowedContent","entities","toolbar","colorButton_colors","colorButton_enableMore","colorButton_enableAutomatic","toolbar_Full","items","ckeditorColor","CkEditorColorController","instanceCondition","action","resource","instance","perms","can","cond","instanceConditions","canManage","manage","canUpdate","canShow","canIndex","customCan","canDirective","attr","watcher","shown","negative","toShow","parsed","split","slice","substr","$on","boxExpander","boxExpanderLink","collapse","me","updateMe","addInstanceConditions","getInstanceConditions","temp_url","runBlock","$rootScope","defaultBodyClasses","stateChangeSuccess","toState","pms","params","bodyClasses","run","routerConfig","$stateProvider","$urlRouterProvider","abstract","currentUser","validateUser","signedIn","levelsData","onEnter","otherwise","constant","$logProvider","toastrConfig","$animateProvider","$locationProvider","$provide","$authProvider","debugEnabled","classNameFilter","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","html5Mode","hashPrefix","configure","tokenValidationPath","signOutUrl","emailRegistrationPath","accountDeletePath","passwordResetPath","passwordUpdatePath","passwordResetSuccessUrl","location","origin","emailSignInPath","$templateCache","put"],"mappings":"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","file":"scripts/app-5f3fd66ca7.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore', [\n      'ngAnimate',\n      'ngCookies',\n      'ngSanitize',\n      'ngMessages',\n      'ui.router',\n      'toastr',\n      'ui.bootstrap',\n      'ng-token-auth',\n      'ckeditor',\n      'ngFileUpload'\n      ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('UnitDestroyController', UnitDestroyController);\n\n  /** @ngInject */\n  function UnitDestroyController($uibModalInstance) {\n    var vm = this;\n\n    vm.ok = function () {\n      $uibModalInstance.close(true);\n    }\n\n    vm.cancel = function () {\n      $uibModalInstance.dismiss();\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('CategoryController', CategoryController)\n\n  /** @ngInject */\n  function CategoryController(models) {\n    var vm = this;\n    vm.models = models;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('exerciseShow', exerciseShow);\n\n  /** @ngInject */\n  function exerciseShow() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/exercise/exerciseShow/exerciseShow.html',\n      controller: ExerciseController,\n      controllerAs: 'exerciseShow',\n      bindToController: true,\n      scope:{\n        model: '=',\n        section: '@',\n        currentsection: '=',\n        currenttab: '@',\n        tabinfo: '@'\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function ExerciseController(models, $state, units, $q, $scope, $uibModal, $timeout) {\n      var vm = this;\n      vm.models = models;\n\n      vm.data = {\n         availableOptions: [\n             {id: 1 , name: 'Dropdown'},\n             {id: 2 , name: 'Completamento'},\n             {id: 3 , name: 'Trova lintruso'},\n             {id: 4 , name: 'Riordina la parola'},\n             {id: 5 , name: 'Riordina le frasi'},\n             {id: 6 , name: 'Connetti immagine/frase'},\n             {id: 7 , name: 'Connetti frase/frase'},\n             {id: 8 , name: 'Vero o Falso'},\n             {id: 9 , name: 'Memory'}\n          ]\n      };\n\n      vm.setLoading = function (res) {\n        vm.loading = true;\n        return $q.resolve(res);\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.uploadImageTipFile = function($file){\n        vm.form.image_tip = $file;\n        vm.form.exercise_tips_image_filename = $file.name;\n      }\n\n      vm.submitImageTip = function(id){\n        var exercise_tips_image_url = \"\";\n        var exercise_tips_image_filename = \"\";\n        return units\n          .uploadImageTipExercise(id, { filename: vm.form.image_tip.name, type: vm.form.image_tip.type })\n          .then(function(res) {\n            exercise_tips_image_filename = res.exercise_tips_image_filename;\n            exercise_tips_image_url = res.exercise_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip.type, vm.form.image_tip)\n          })\n          .then(function(){\n            vm.form.exercise_tips_image_url = exercise_tips_image_url;\n            vm.form.exercise_tips_image_filename = exercise_tips_image_filename;\n            vm.model.exercise_tips_image_url = exercise_tips_image_url;\n            vm.model.exercise_tips_image_filename = exercise_tips_image_filename;\n            delete vm.form.image_tip;\n          });\n      }\n\n\n      vm.submit = function () {\n          vm.setLoading();\n\n          vm.form.exercise_type = vm.exercise_type_temp.id;\n\n          if(vm.exercise_text_text_items){\n            if(vm.form.exercise_image_text_items){\n              delete vm.form.exercise_image_text_items;\n            }\n            if(vm.form.exercise_text){\n              delete vm.form.exercise_text;\n            }\n            vm.form.exercise_text_text_items = angular.copy(vm.exercise_text_text_items);\n          }\n          else if(vm.exercise_image_text_items){\n            if(vm.form.exercise_text_text_items){\n              delete vm.form.exercise_text_text_items;\n            }\n            if(vm.form.exercise_text){\n              delete vm.form.exercise_text;\n            }\n            vm.form.exercise_image_text_items = angular.copy(vm.exercise_image_text_items);\n          }\n          else if(vm.exercise_text){\n            if(vm.form.exercise_image_text_items){\n              delete vm.exercise_image_text_items;\n            }\n            if(vm.form.exercise_text_text_items){\n              delete vm.form.exercise_text_text_items;\n            }\n            vm.form.exercise_text = angular.copy(vm.exercise_text);\n          }\n\n          var uploadPromises = [];\n          if(vm.form.exercise_image_text_items){\n              //se non ho ancora l'item.id devo fare prima una create\n              angular.forEach(vm.form.exercise_image_text_items, function(item){\n                  if(!item.id){\n                    var item_temp = {\n                        'item_number': item.item_number,\n                        'image_url': '',\n                        'image_filename': item.image.file.name,\n                        'text_en': item.text_en\n                    };\n\n                  var promise = units\n                      .createExerciseImage(vm.form.id, {'exercise_image_text_item': item_temp})\n                      .then(function(res){\n                        item.id = res.exercise_image_text_item.id;\n                      })\n                  uploadPromises.push(promise);\n                }\n              });\n          }\n          //return vm.setLoading()\n          return $q\n          .all(uploadPromises)\n          .then(function(){\n            if(vm.form.image_tip && vm.form.image_tip.name){\n              return vm.submitImageTip(vm.form.id);\n            }\n          })\n          .then(function(){\n            return units.updateExercise(vm.form.id,  {'exercise':vm.form})\n            })\n          .then(function(res){\n            var flag = true;\n            angular.forEach(vm.currentsection, function(value, key) {\n              if(flag && res.exercise.id == value.id){\n                vm.currentsection[key] = angular.copy(res.exercise);\n                flag = false;\n              }\n            });\n            return res;\n          })\n          .finally(function(){\n            $timeout(function () {\n              vm.unsetLoading();\n              angular.element(vm.currenttab).tab('show');\n            }, 100);\n          });\n      }\n\n      vm.destroy = function() {\n        $uibModal.open({\n            templateUrl: 'app/components/exercise/destroy/destroy.html',\n            controller: 'ExerciseDestroyController',\n            controllerAs: 'exerciseDestroy',\n            windowClass: 'modal-default'\n          }).result\n          .then(function (res) {\n            vm.setLoading();\n            if(res === true){\n              return units\n                  .destroyExercise(vm.form)\n                  .then(function(){\n                    angular.forEach(vm.currentsection, function(value, key) {\n                      if(vm.form.id == value.id){\n                        vm.currentsection.splice(key,1);\n                        return;\n                      }\n                    });\n                  })\n            }\n          })\n          .finally(function(){\n            $timeout(function () {\n              vm.unsetLoading();\n              if(vm.section === 'UnitSectionD'){\n                angular.element(\"#sectionD .tab-pane\").removeClass('active in');\n                angular.element(\"#sectionD #info-tab-d\").addClass('active in');\n              }\n              else if(vm.section === 'UnitSectionE'){\n                angular.element(\"#sectionE .tab-pane\").removeClass('active in');\n                angular.element(\"#sectionE #info-tab-e\").addClass('active in');\n              }\n              angular.element(vm.tabinfo).tab('show');\n            }, 100);\n          });\n      }\n\n      $scope.$watch('exerciseShow.model', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n            vm.form = angular.copy(vm.model);\n        }\n      });\n\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('ExerciseDestroyController', ExerciseDestroyController);\n\n  /** @ngInject */\n  function ExerciseDestroyController($uibModalInstance) {\n    var vm = this;\n\n    vm.ok = function () {\n      $uibModalInstance.close(true);\n    }\n\n    vm.cancel = function () {\n      $uibModalInstance.dismiss();\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('UnitController', UnitController);\n\n  /** @ngInject */\n  function UnitController(models, units, $stateParams) {\n    var vm = this;\n    vm.models = models;\n\n    units.show($stateParams.id)\n          .then(function(res){\n            units.getSectionA(res.unit.unit_section_a.id);\n            units.getSectionB(res.unit.unit_section_b.id);\n            units.getSectionC(res.unit.unit_section_c.id);\n            units.getSectionD(res.unit.unit_section_d.id);\n            units.getSectionE(res.unit.unit_section_e.id);\n          });\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('ProfileController', ProfileController);\n\n  /** @ngInject */\n  function ProfileController(models) {\n    var vm = this;\n    vm.models = models;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('LoginController', LoginController);\n\n  /** @ngInject */\n  function LoginController(users, $state, galoreApi, errorManager) {\n    var vm = this;\n\n    vm.user = vm.user || {};\n\n    // Login with username and password\n    vm.login = function () {\n      galoreApi\n        .login(vm.user)\n        .then(function () {\n          $state.go('main.admin.dashboard');\n        })\n        .catch(errorManager);\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('DashboardController', DashboardController);\n\n  /** @ngInject */\n  function DashboardController(models) {\n    var vm = this;\n    vm.models = models;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('FaqController', FaqController)\n\n  /** @ngInject */\n  function FaqController(models) {\n    var vm = this;\n    vm.models = models;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('CreateUnitController', CreateUnitController)\n    .filter('range', RangeFilter);\n\n  /** @ngInject */\n  function CreateUnitController(models) {\n    var vm = this;\n    vm.models = models;\n  }\n\n  function RangeFilter(){\n    return function(input, min, max) {\n        min = parseInt(min);\n        max = parseInt(max);\n        for (var i=min; i<max; i++)\n          input.push(i);\n        return input;\n      };\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .controller('AdminController', AdminController)\n\n  /** @ngInject */\n  function AdminController(models) {\n    var vm = this;\n\n    vm.models = models;\n  }\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * UI state service.\n   * Keep application-wide shared variables\n   */\n  .factory('utils', function () {\n    var idCount = 0;\n\n    var utils = {\n\n      nextId: function(){\n        return idCount++;\n      },\n      /**\n       * Find the first occurrence of an object (given an 'id' field) in an array\n       */\n      findFirst: function(array,id) {\n        for (var i = 0; i < array.length; i++) {\n          if(array[i].id === id){\n            return array[i];\n          }\n        }\n        return null;\n      },\n\n      /**\n       * Find the first occurrence of an object (given a 'name' field) in an array\n       */\n      findFirstByName: function(array,name) {\n        for (var i = 0; i < array.length; i++) {\n          if(array[i].name === name){\n            return array[i];\n          }\n        }\n        return null;\n      },\n\n      /**\n      * Remove the first occurence of a an object (given an 'id' field) in an array\n      */\n      removeFirst: function (array, id) {\n        var found = false;\n        for (var i = 0; i < array.length; i++) {\n          if(array[i].id === id){\n            found = i;\n            break;\n          }\n        }\n        array.splice(found,1);\n      },\n\n      /**\n       * Sort given array by 'order' key\n       */\n      sortByOrder: function(array) {\n        if(angular.isArray(array)){\n          return array.sort(function(a,b) {\n            if(a.order > b.order){\n              return 1;\n            }\n            if(a.order < b.order){\n              return -1;\n            }\n            return 0;\n          });\n        }\n        return array;\n      },\n\n      /**\n       * Try to merge elem to a target object with the same id in array\n       * If the target doesn't exist, push elem in the array\n       */\n      mergeOrPush: function(array,elem) {\n        var added = utils.merge(array, elem);\n        if(!added){\n          added = elem;\n          array.push(added);\n        }\n        return added;\n      },\n\n      /**\n       * Merge elem to a target object with the same id in array\n       * If the target doesn't exist, return null\n       */\n      merge: function(array, elem) {\n        var found = utils.findFirst(array, elem.id);\n        if(found){\n          angular.merge(found, elem);\n        }\n        return found;\n      }\n    };\n\n    return utils;\n  });\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('file', file);\n\n  /** @ngInject */\n  function file() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/uploadFile/uploadFile.html',\n      link: UploadFileLink,\n      scope:{\n        model: '='\n      }\n    };\n\n    return directive;\n\n\n    function UploadFileLink(scope, el) {\n      el.bind('change', function(event){\n          var files = event.target.files;\n          var file = files[0];\n          scope.model.file = file;\n          scope.$apply();\n        });\n    }\n\n  }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * UI state service.\n   * Keep application-wide shared variables\n   */\n  .factory('uiState', function () {\n    var uiState = {};\n\n    return uiState;\n  });\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('toggleSwitch', toggleSwitch);\n\n  /** @ngInject */\n  function toggleSwitch() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/toggleSwitch/toggleSwitch.html',\n      controller: ToggleSwitchController,\n      controllerAs: 'toggleSwitch',\n      bindToController: true,\n      scope:{\n        model: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function ToggleSwitchController(models, units){\n      var vm = this;\n      vm.models = models;\n\n      vm.publish = function(){\n        units\n          .publishUnit(vm.model.id)\n          .then(function(){\n            vm.model.published = true;\n          });\n      }\n\n      vm.unpublish = function(){\n        units\n        .unpublishUnit(vm.model.id)\n        .then(function(){\n          vm.model.published = false;\n        });\n      }\n    }\n  }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('tabVideo', tabVideo);\n\n    /** @ngInject */\n    function tabVideo(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/tabVideo/tabVideo.html',\n        controller: TabVideoController,\n        controllerAs: 'tabVideo',\n        bindToController: true,\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n\n      /** @ngInject */\n      function TabVideoController(models, $scope) {\n        var vm = this;\n        vm.models = models;\n\n\n        vm.uploadVideoFile = function($file){\n          vm.model.video = $file;\n          vm.model.video_filename = $file.name;\n        };\n\n\n        vm.uploadImageTipFile = function($file){\n          vm.model.image_tip = $file;\n          vm.model.video_tips_image_filename = $file.name;\n        };\n\n        $scope.$watch('tabVideo.model', function (newVal, oldVal) {\n            if(newVal !== oldVal) {\n              vm.model.video = {};\n            }\n        });\n      }\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('tabTheoryInDepth', tabTheoryInDepth);\n\n    /** @ngInject */\n    function tabTheoryInDepth(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/tabTheoryInDepth/tabTheoryInDepth.html',\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('tabTheory', tabTheory);\n\n    /** @ngInject */\n    function tabTheory(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/tabTheory/tabTheory.html',\n        controller: TabTheoryController,\n        controllerAs: 'tabTheory',\n        bindToController: true,\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n\n      /** @ngInject */\n      function TabTheoryController(models) {\n\n        var vm = this;\n        vm.models = models;\n\n        vm.uploadImageTipFile = function($file){\n          vm.model.image_tip_theory = $file;\n          vm.model.exercise_tips_image_filename = $file.name;\n        }\n      }\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('tabInfoSection', tabInfoSection);\n\n    /** @ngInject */\n    function tabInfoSection(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/tabInfoSection/tabInfoSection.html',\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('tabDialogue', tabDialogue);\n\n    /** @ngInject */\n    function tabDialogue(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/tabDialogue/tabDialogue.html',\n        controller: TabDialogueController,\n        controllerAs: 'tabDialogue',\n        bindToController: true,\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n\n      /** @ngInject */\n      function TabDialogueController($scope, models) {\n        var vm = this;\n        vm.models = models;\n\n        vm.uploadImageTipFile = function($file){\n          vm.model.image_tip = $file;\n          vm.model.dialogue_tips_image_filename = $file.name;\n        };\n\n        vm.uploadAudioFile = function($files){\n          vm.model.files_audio = $files;\n        };\n\n        vm.removeFile = function(file, index){\n            if(file.id && vm.model.audio_items){\n              angular.forEach(vm.model.audio_items, function(el, key){\n                if(el.id == file.id){\n                  el._destroy = true;\n                  vm.model.audio_items_temp[key]._destroy = true;\n                }\n              })\n            }else{\n                 vm.model.files_audio.splice(index, 1);\n            }\n        }\n\n        $scope.dynamicPopover = {\n            templateUrl: 'app/components/sectionB/infoPopoverTemplate.html'\n          };\n\n          $scope.$watch('tabDialogue.model.audio_items', function (newVal, oldVal) {\n            if(newVal !== oldVal) {\n              vm.model.audio_items_temp = angular.copy(vm.model.audio_items);\n            }\n          });\n      }\n    }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('showOnHover', showOnHover);\n\n  /** @ngInject */\n  function showOnHover() {\n    var directive = {\n      restrict: 'A',\n      link: linkFunc,\n      scope: {\n        showOnHover: '@',\n        showAnimate: '='\n      }\n    };\n\n    return directive;\n\n    function linkFunc(scope, el) {\n      var visible = false;\n      var target = angular.element(scope.showOnHover);\n\n      scope.$watch('showOnHover', function () {\n        target.removeClass('show-on-hover-target').removeClass('not-visible').removeClass('show-animate');\n        target = angular.element(scope.showOnHover);\n        target.addClass('show-on-hover-target');\n        if(scope.showAnimate){\n          target.addClass('show-animate');\n        }\n        scope.updateVisibility();\n      })\n\n      scope.updateVisibility = function () {\n        if(visible){\n          target.removeClass('not-visible');\n        }\n        else{\n          target.addClass('not-visible');\n        }\n      }\n\n      el.hover(function() {\n          if(!visible){\n            visible = true;\n            scope.updateVisibility();\n          }\n        },\n        function() {\n          if(visible){\n            visible = false;\n            scope.updateVisibility();\n          }\n        }\n      );\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionUnit', sectionUnit);\n\n  /** @ngInject */\n  function sectionUnit() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionUnit/sectionUnit.html',\n      controller: SectionUnitController,\n      controllerAs: 'sectionUnit',\n      bindToController: true,\n      scope: {\n        unit: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionUnitController(models, $state, units, $q, $scope, $http, $uibModal) {\n      var vm = this;\n      vm.models = models;\n\n      vm.setLoading = function () {\n        vm.loading = true;\n        return $q.resolve();\n      }\n\n      vm.unsetLoading = function () {\n        vm.loading = false;\n        return $q.resolve();\n      }\n\n      vm.submit = function (id) {\n        return vm.setLoading()\n        .then(function(){\n          return units.update(id, {'unit': vm.form});\n        })\n        .finally(vm.unsetLoading);\n      }\n\n      vm.destroy = function() {\n        $uibModal.open({\n            templateUrl: 'app/pages/unit/destroy/destroy.html',\n            controller: 'UnitDestroyController',\n            controllerAs: 'unitDestroy',\n            windowClass: 'modal-default'\n          }).result\n          .then(function (res) {\n            if(res === true){\n              return units.destroyUnit(vm.form);\n            }\n          })\n          .then($state.go('main.admin.dashboard'))\n      }\n\n      vm.animationsEnabled = true;\n\n      $scope.$watch('sectionUnit.unit', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n          vm.form = angular.copy(vm.models.current_unit);\n        }\n      });\n\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionE', sectionE);\n\n  /** @ngInject */\n  function sectionE() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionE/sectionE.html',\n      controller: SectionEController,\n      controllerAs: 'sectionE',\n      bindToController: true,\n      scope:{\n        section: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionEController(models, $state, units, $q, $scope) {\n      var vm = this;\n      vm.models = models;\n\n      vm.activeTabIndex = 0\n      vm.tabs = [];\n\n      vm.setLoading = function (res) {\n        vm.loading = true;\n        return $q.resolve(res);\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.submit = function () {\n        return vm.setLoading()\n          .then(units.updateSection('e',vm.form.id,{'unit_section_e': vm.form}))\n          .finally(vm.unsetLoading);\n      }\n\n      vm.getExercises = function(isCollapsed){\n        if(isCollapsed){\n          return vm.setLoading()\n           .then(units.getExercises('e', vm.form.id))\n           .finally(vm.unsetLoading);\n        }\n      }\n\n      $scope.$watch('sectionE.section', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n          vm.form = angular.copy(vm.section);\n        }\n      });\n\n      $scope.$watch('sectionE.models.current_unit_sections_e_exercises.exercises', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n            vm.models.current_unit_sections_e_exercises.exercises = newVal;\n        }\n      });\n\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionD', sectionD);\n\n  /** @ngInject */\n  function sectionD() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionD/sectionD.html',\n      controller: SectionDController,\n      controllerAs: 'sectionD',\n      bindToController: true,\n      scope: {\n        section: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionDController(models, $state, units, $q, $scope) {\n      var vm = this;\n      vm.models = models;\n\n      vm.setLoading = function () {\n        vm.loading = true;\n        return $q.resolve();\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.getExercises = function(isCollapsed){\n        if(isCollapsed){\n         return vm.setLoading()\n          .then(units.getExercises('d', vm.form.id))\n          .finally(vm.unsetLoading);\n        }\n      }\n\n      vm.submitUpload = function(id){\n        var video_url = \"\";\n        var video_filename = \"\";\n        return units\n          .uploadVideo('d', id, { filename: vm.form.video.name, type: vm.form.video.type })\n          .then(function(res) {\n            video_filename = res.video_filename;\n            video_url = res.video_url;\n            return units.uploadFileS3(res.upload_url, vm.form.video.type, vm.form.video)\n          })\n          .then(function(){\n            vm.form.video_url = video_url;\n            vm.section.video_url = video_url;\n            vm.form.video_filename = video_filename;\n            vm.section.video_filename = video_filename;\n            delete vm.form.video;\n          });\n      }\n\n      vm.submitImageTip = function(id){\n        var video_tips_image_url = \"\";\n        var video_tips_image_filename = \"\";\n        return units\n          .uploadImageTip('d', id, 'video_tips_image_upload', { filename: vm.form.image_tip.name, type: vm.form.image_tip.type })\n          .then(function(res) {\n            video_tips_image_filename = res.video_tips_image_filename;\n            video_tips_image_url = res.video_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip.type, vm.form.image_tip)\n          })\n          .then(function(){\n            vm.form.video_tips_image_url = video_tips_image_url;\n            vm.form.video_tips_image_filename = video_tips_image_filename;\n            vm.section.video_tips_image_url = video_tips_image_url;\n            vm.section.video_tips_image_filename = video_tips_image_filename;\n            delete vm.form.image_tip;\n          });\n      }\n\n      vm.submitImageTheoryTip = function(id){\n        var theory_text_tips_image_url = \"\";\n        var theory_text_tips_image_filename = \"\";\n        return units\n          .uploadImageTip('d', id, 'theory_text_tips_image_upload', { filename: vm.form.image_tip_theory.name, type: vm.form.image_tip_theory.type })\n          .then(function(res) {\n            theory_text_tips_image_filename = res.theory_text_tips_image_filename;\n            theory_text_tips_image_url = res.theory_text_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip_theory.type, vm.form.image_tip_theory)\n          })\n          .then(function(){\n            vm.form.theory_text_tips_image_url = theory_text_tips_image_url;\n            vm.form.theory_text_tips_image_filename = theory_text_tips_image_filename;\n            vm.section.theory_text_tips_image_url = theory_text_tips_image_url;\n            vm.section.theory_text_tips_image_filename = theory_text_tips_image_filename;\n            delete vm.form.image_tip_theory;\n          });\n      }\n\n      vm.submitSection = function(id){\n        return units.updateSection('d',id,{'unit_section_d': vm.form});\n      }\n\n      vm.submit = function () {\n\n        return vm.setLoading()\n          .then(function(){\n            if(vm.form.video && vm.form.video.name){\n              return vm.submitUpload(vm.section.id);\n            }\n            if(vm.form.image_tip && vm.form.image_tip.name){\n              return vm.submitImageTip(vm.section.id);\n            }\n            if(vm.form.image_tip_theory && vm.form.image_tip_theory.name){\n              return vm.submitImageTheoryTip(vm.section.id);\n            }\n          })\n          .then(function(){\n            return vm.submitSection(vm.section.id);\n          })\n          .finally(vm.unsetLoading);\n      }\n\n      vm.removeVideo = function(){\n        vm.form.video_url = \"\";\n        vm.form.video = null;\n      }\n\n      $scope.$watch('sectionD.section', function (newVal, oldVal) {\n          if(newVal !== oldVal) {\n            vm.form = angular.copy(vm.section);\n          }\n      });\n\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionC', sectionC);\n\n  /** @ngInject */\n  function sectionC() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionC/sectionC.html',\n      controller: SectionCController,\n      controllerAs: 'sectionC',\n      bindToController: true,\n      scope:{\n        section: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionCController(models, $state, units, $q, $scope, utils) {\n      var vm = this;\n      vm.models = models;\n\n      vm.counterC = utils.nextId();\n\n      vm.activeTabIndex = 0\n\n      vm.setLoading = function (res) {\n        vm.loading = true;\n        return $q.resolve(res);\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.submit = function () {\n        return vm.setLoading()\n          .then(units.updateSection('c',vm.form.id,{'unit_section_c': vm.form}))\n          .finally(vm.unsetLoading);\n      }\n\n      vm.getExercises = function(isCollapsed){\n        if(isCollapsed){\n         return vm.setLoading()\n          .then(function(){\n            return units.getExercises('c', vm.form.id)\n          })\n          .then(function(res){\n            vm.form.current_unit_sections_c_exercises = [];\n            vm.form.current_unit_sections_c_exercises.exercises = angular.copy(res.exercises);\n          })\n          .finally(vm.unsetLoading);\n        }\n      }\n\n      $scope.$watch('sectionC.section', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n          vm.form = angular.copy(vm.section);\n        }\n      });\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionB', sectionB);\n\n  /** @ngInject */\n  function sectionB() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionB/sectionB.html',\n      controller: SectionBController,\n      controllerAs: 'sectionB',\n      bindToController: true,\n      scope:{\n        section: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionBController(models, $state, units, $q, $scope, $timeout) {\n      var vm = this;\n      vm.models = models;\n      var uploadPromises = [];\n\n      vm.changeStatusSection = function(){\n        vm.submit();\n      }\n\n      vm.setLoading = function (res) {\n        vm.loading = true;\n        return $q.resolve(res);\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n       vm.createFilesAudio = function(){\n        var audio_url = \"\";\n        if(!vm.form.audio_items){\n          vm.form.audio_items = [];\n        }\n        angular.forEach(vm.form.files_audio, function(item){\n          var audio = {};\n          if(item && item.name && !item._destroy){\n            var promise = units\n              .createFileAudio(vm.section.id, {'audio_item':{\n                'audio_url': \"\",\n                'audio_filename': item.name\n              }})\n              .then(function(res){\n                audio.id = res.audio_item.id;\n                audio.file_name = res.audio_item.audio_filename;\n                return units\n                  .uploadFileAudio(vm.section.id, res.audio_item.id, { filename: item.name, type: item.type })\n                  .then(function(res) {\n                     audio_url = res.audio_url;\n                     return units.uploadFileS3(res.upload_url, item.type, item)\n                   })\n                   .then(function(){\n                     audio.audio_url = audio_url;\n                     audio.audio_filename = audio.file_name;\n                     vm.form.audio_items.push(audio);\n                   });\n              });\n            uploadPromises.push(promise);\n          }\n        });\n       }\n\n      vm.submitImageTip = function(id){\n        var dialogue_tips_image_url = \"\";\n        var dialogue_tips_image_filename = \"\";\n        return units\n          .uploadImageTip('b', id, 'dialogue_tips_image_upload', { filename: vm.form.image_tip.name, type: vm.form.image_tip.type })\n          .then(function(res) {\n            dialogue_tips_image_filename = res.dialogue_tips_image_filename;\n            dialogue_tips_image_url = res.dialogue_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip.type, vm.form.image_tip)\n          })\n          .then(function(){\n            vm.form.dialogue_tips_image_url = dialogue_tips_image_url;\n            vm.form.dialogue_tips_image_filename = dialogue_tips_image_filename;\n            vm.section.dialogue_tips_image_url = dialogue_tips_image_url;\n            vm.section.dialogue_tips_image_filename = dialogue_tips_image_filename;\n            delete vm.form.image_tip;\n          });\n      }\n\n      vm.submitSection = function(){\n        delete vm.form.audio_items_temp;\n        return units.updateSection('b',vm.form.id,{'unit_section_b': vm.form});\n      }\n\n      vm.submit = function () {\n        return vm.setLoading()\n          .then(function(){\n            if(vm.form.image_tip && vm.form.image_tip.name){\n              return vm.submitImageTip(vm.section.id);\n            }\n            if(vm.form.files_audio && vm.form.files_audio.length > 0){\n              vm.createFilesAudio();\n              return $q\n              .all(uploadPromises)\n            }\n          })\n          .then(function(){\n            delete vm.form.video;\n            delete vm.form.files_audio;\n            return vm.submitSection(vm.section.id);\n          })\n          .then(function(res){\n            vm.form.audio_items = angular.copy(res.unit_section_b.audio_items);\n            uploadPromises = [];\n          })\n          .finally(vm.unsetLoading);\n      }\n\n      $scope.$watch('sectionB.section', function (newVal, oldVal) {\n        if(newVal !== oldVal) {\n          vm.form = angular.copy(vm.section);\n        }\n      });\n\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('sectionA', sectionA);\n\n  /** @ngInject */\n  function sectionA() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/sectionA/sectionA.html',\n      controller: SectionAController,\n      controllerAs: 'sectionA',\n      bindToController: true,\n      scope: {\n        section: '='\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SectionAController(models, $state, units, $q, $scope) {\n      var vm = this;\n      vm.models = models;\n\n      vm.setLoading = function () {\n        vm.loading = true;\n        return $q.resolve();\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.submitUpload = function(id){\n        var video_url = \"\";\n        var video_filename = \"\";\n        return units\n          .uploadVideo('a', id, { filename: vm.form.video.name, type: vm.form.video.type })\n          .then(function(res) {\n            video_filename = res.video_filename;\n            video_url = res.video_url;\n            return units.uploadFileS3(res.upload_url, vm.form.video.type, vm.form.video)\n          })\n          .then(function(){\n            vm.form.video_url = video_url;\n            vm.form.video_filename = video_filename;\n            vm.section.video_url = video_url;\n            vm.section.video_filename = video_filename;\n            delete vm.form.video;\n          });\n      }\n\n      vm.submitImageTip = function(id){\n        var video_tips_image_url = \"\";\n        var video_tips_filename = \"\";\n        return units\n          .uploadImageTip('a', id, 'video_tips_image_upload', { filename: vm.form.image_tip.name, type: vm.form.image_tip.type })\n          .then(function(res) {\n            video_tips_filename = res.video_tips_filename;\n            video_tips_image_url = res.video_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip.type, vm.form.image_tip)\n          })\n          .then(function(){\n            vm.form.video_tips_image_url = video_tips_image_url;\n            vm.form.video_tips_filename = video_tips_filename;\n            vm.section.video_tips_image_url = video_tips_image_url;\n            vm.section.video_tips_filename = video_tips_filename;\n            delete vm.form.image_tip;\n          });\n      }\n\n      vm.submitSection = function(id){\n        return units.updateSection('a',id,{'unit_section_a': vm.form});\n      }\n\n      vm.submit = function () {\n        return vm.setLoading()\n          .then(function(){\n            if(vm.form.video && vm.form.video.name){\n              return vm.submitUpload(vm.section.id);\n            }\n            if(vm.form.image_tip && vm.form.image_tip.name){\n              return vm.submitImageTip(vm.section.id);\n            }\n          })\n          .then(function(){\n            delete vm.form.video;\n            return vm.submitSection(vm.section.id);\n          })\n          .finally(vm.unsetLoading);\n      }\n\n      vm.removeVideo = function(){\n        vm.form.video_url = \"\";\n        $scope.file = null;\n      }\n\n      $scope.$watch('sectionA.section', function (newVal, oldVal) {\n          if(newVal !== oldVal) {\n            vm.form = angular.copy(vm.section);\n          }\n      });\n\n    }\n\n  }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * Response management pipeline.\n   * Utilities to process a response from the moment it arrives to the models update.\n   * To use in a promise chain as a pipeline\n   */\n  .factory('resPipe', function (longTermMemory, models, utils, $log, apiUrl) {\n    var resPipe = {\n\n      /**\n       * Parse the initial response\n       */\n      parseResponse: function(res) {\n        // Look for a valid model inside the response\n        for (var i = 0; i < helpers.validModels.length; i++) {\n          if(res[helpers.validModels[i]]){\n            res._model = helpers.validModels[i]; // Put the name of the model in res._model\n            break;\n          }\n        }\n        return res;\n      },\n\n      /**\n       * Inject some default values inside the response\n       */\n      injectDefaults: function(res) {\n        // Parse the model depending of its nature\n        var model = helpers.fetchModel(res);\n        if(model){\n          switch(res._model){\n            case 'projects':\n            case 'project':\n              helpers.forEachModel(model, helpers.injectProjectDefaults);\n              break;\n            case 'users':\n            case 'user':\n              helpers.forEachModel(model, helpers.injectUserDefaults);\n              break;\n            default:\n              break;\n          }\n        }\n        return res;\n      },\n\n      /**\n      * Mark the model as to be reloaded. This allows the resPipe to delete it\n      * from cache (if present) and to add it again\n      */\n      markReload: function (res) {\n        var model = helpers.fetchModel(res);\n        helpers.forEachModel(model, function (m) {\n          m._reload = true;\n        });\n        return res;\n      },\n\n\n      /**\n      * Mark the model as destroyed. This allows the resPipe to delete it\n      * from cache (if present)\n      */\n      markDestroyed: function (res) {\n        var model = helpers.fetchModel(res);\n        helpers.forEachModel(model, function (m) {\n          m._destroyed = true;\n        });\n        return res;\n      },\n\n      /**\n       * Remove a unit from the model level\n       */\n      removeUnitFromLevels: function (unitId, levelId) {\n        if(!models.levels) return;\n\n        // Look for the right player\n        for (var i = 0; i < models.levels[levelId].units.length; i++) {\n          var curUnit = models.levels[levelId].units[i];\n          if(curUnit.id === unitId){\n            models.levels[levelId].units.splice(i,1);\n          }\n        }\n        return models.levels;\n      },\n\n      /**\n       * Sort frames and comments in projects\n       */\n      sortFramesAndComments: function(res) {\n        var model = helpers.fetchModel(res);\n        if(angular.isArray(model)){\n          angular.forEach(model, function(project) {\n            helpers.sortFramesAndCommentsSingle(project);\n          });\n        }\n        else if(model){\n          helpers.sortFramesAndCommentsSingle(model);\n        }\n        return res;\n      },\n\n      /**\n       * Sort frames in cache\n       */\n      sortFramesCache: function(res) {\n        var project = helpers.getRelatedProject(res);\n        if(project && project.frames){\n          utils.sortByOrder(project.frames);\n        }\n        return res;\n      },\n\n      /**\n       * Sort Comments given order\n       */\n      sortCommentsCache: function(res) {\n        var frame = helpers.getRelatedFrame(res);\n        if(frame && frame.comments){\n          utils.sortByOrder(frame.comments);\n        }\n        return res;\n      },\n\n      /**\n       * Update models cache\n       */\n      updateCache: function(res) {\n        var model = helpers.fetchModel(res);\n        var level = null;\n        if(model){\n          switch(res._model){\n            case 'levels':\n              res[res._model] = helpers.updateModelCache(models.levels, model);\n              break;\n            case 'unit':\n              level = helpers.getRelatedLevel(res);\n              res[res._model] = helpers.updateModelCache(level.units, model);\n              break;\n            case 'unit_section_a':\n              res[res._model] = helpers.updateModelCache(models.current_unit_section_a, model);\n              break;\n            case 'unit_section_b':\n              res[res._model] = helpers.updateModelCache(models.current_unit_section_b, model);\n              break;\n            case 'unit_section_c':\n              res[res._model] = helpers.updateModelCache(models.current_unit_section_c, model);\n              break;\n            case 'unit_section_d':\n              res[res._model] = helpers.updateModelCache(models.current_unit_section_d, model);\n              break;\n            case 'unit_section_e':\n              res[res._model] = helpers.updateModelCache(models.current_unit_section_e, model);\n              break;\n            case 'unit_sections_c_exercises':\n              res[res._model] = helpers.updateModelCache(models.current_unit_sections_c_exercises, model);\n              break;\n            case 'unit_sections_d_exercises':\n              res[res._model] = helpers.updateModelCache(models.current_unit_sections_d_exercises, model);\n              break;\n            case 'unit_sections_e_exercises':\n              res[res._model] = helpers.updateModelCache(models.current_unit_sections_e_exercises, model);\n              break;\n            case 'exercise':\n              res[res._model] = helpers.updateModelCache(models.current_exercise, model);\n              break;\n            case 'user':\n            case 'users':\n              res[res._model] = helpers.updateModelCache(models.users, model);\n              break;\n            default:\n              break;\n          }\n        }\n        return res;\n      },\n\n      /**\n       * Update models cache\n       */\n      cleanCache: function(res) {\n        var model = helpers.fetchModel(res);\n        if(model){\n          switch(res._model){\n            case 'users':\n              models.users = [];\n              if(models.current_user){\n                models.users.push(models.current_user);\n              }\n              break;\n            default:\n              break;\n          }\n        }\n        return res;\n      },\n\n      /**\n       * Prune the cache, removing old projects which probably has been deleted\n       */\n      pruneProjectCache: function(res) {\n        if(angular.isArray(res.projects)){\n          var ids = [];\n          var newCache = [];\n          // Remember projects returned by server in the response\n          angular.forEach(res.projects, function(project) {\n            ids.push(project.id);\n          });\n          // Keep in cache only allowed projects\n          angular.forEach(models.projects, function(project) {\n            // If the project was present in response, or if the project is not mine, keep.\n            // (Don't keep the project if it's mine but it's not present in response. This means it's been recently deleted)\n            if(ids.indexOf(project.id) >= 0 || project.owner.id !== models.current_user.id){\n              newCache.push(project);\n            }\n          });\n          models.projects = newCache; // Replace the cache\n        }\n        return res;\n      },\n\n      /**\n       * Prune the cache, removing old projects which probably has been deleted\n       */\n      forcePruneProjectCache: function(res) {\n        if(angular.isArray(res.projects)){\n          var ids = [];\n          var newCache = [];\n          // Remember projects returned by server in the response\n          angular.forEach(res.projects, function(project) {\n            ids.push(project.id);\n          });\n          // Keep in cache only allowed projects\n          angular.forEach(models.projects, function(project) {\n            // Keep only the projects that are in response\n            if(ids.indexOf(project.id) >= 0){\n              newCache.push(project);\n            }\n          });\n          models.projects = newCache; // Replace the cache\n        }\n        return res;\n      },\n\n      /**\n       * Removes a model from cache\n       */\n      removeFromCache: function(res) {\n        var model = helpers.fetchModel(res);\n        if(model){\n          switch(res._model){\n            case 'project_files':\n            case 'project_file':\n              helpers.forEachModel(model, helpers.removeProjectFileFromCache);\n              break;\n            default:\n              break;\n          }\n        }\n        return res;\n      },\n\n      /**\n       * Set the project(s) as mine mocking an owner\n       */\n      setProjectAsMine: function(res) {\n        var model = helpers.fetchModel(res);\n        helpers.forEachModel(model, helpers.setProjectAsMineSingle);\n        return res;\n      },\n\n      updateCurrent: function(res){\n        var model = helpers.fetchModel(res);\n        if(model._destroyed){\n          delete models['current_' + res._model];\n        }\n        else{\n          models['current_' + res._model] = res[res._model];\n        }\n        return res;\n      },\n\n      /**\n       * Convert values to a human readable format\n       */\n      humanize: function(res) {\n        var model = helpers.fetchModel(res);\n        if(model){\n          switch(res._model){\n            case 'projects':\n            case 'project':\n              helpers.forEachModel(model, helpers.humanizeProject);\n              break;\n            default:\n              break;\n          }\n        }\n        return res;\n      },\n\n      /**\n       * Store models cache in long term memory\n       */\n      memorizeCache: function(res) {\n        angular.forEach(models, function(v, k){\n          longTermMemory.memorize(k,v);\n        })\n        return res;\n      },\n\n      /**\n       * Manage side effects, if any\n       */\n      sideEffects: function(res) {\n        if(res.side_effects){\n          angular.forEach(res.side_effects, function(v,k) {\n            var project = null;\n            var frame = null;\n\n            switch(k){\n              case 'projects':\n              case 'project':\n                helpers.updateModelCache(models.projects, v);\n                break;\n              case 'user':\n              case 'users':\n                helpers.updateModelCache(models.users, v);\n                break;\n              case 'frames':\n              case 'frame':\n                project = helpers.getRelatedProject(res);\n                helpers.updateModelCache(project.frames, v);\n                break;\n              case 'project_files':\n              case 'project_file':\n                project = helpers.getRelatedProject(res);\n                helpers.updateModelCache(project.project_files, v);\n                break;\n              case 'comments':\n              case 'comment':\n                frame = helpers.getRelatedFrame(res);\n                helpers.updateModelCache(frame.comments, v);\n                break;\n              default:\n                $log.warn('Don\\'t know how to handle side effect \"' + k + '\":');\n                $log.warn(v);\n                break;\n            }\n          });\n        }\n        return res;\n      },\n\n      log: function (res) {\n        $log.info(res);\n        return res;\n      },\n\n      debugger: function (res) {\n        debugger; // eslint-disable-line no-debugger\n        return res;\n      }\n    };\n\n    var helpers = {\n\n      /**\n       * Valid models names\n       */\n      validModels: [\n        'levels',\n        'unit',\n        'unit_section_a',\n        'unit_section_b',\n        'unit_section_c',\n        'unit_section_d',\n        'unit_section_e',\n        'unit_sections_c_exercises',\n        'unit_sections_d_exercises',\n        'unit_sections_e_exercises',\n        'exercise',\n        'users',\n        'user'\n      ],\n\n      /**\n       * Fetch the model from response\n       */\n      fetchModel: function(res) {\n        if(res._model && res[res._model]){\n          return res[res._model];\n        }\n        return null;\n      },\n\n      /**\n      * Get the related project referenced in res\n      */\n      getRelatedProject: function (res) {\n        return utils.findFirst(models.projects, res._project_id);\n      },\n\n      /**\n      * Get the related project referenced in res\n      */\n      getRelatedLevel: function (res) {\n        return utils.findFirst(models.levels, res[res._model].level_id);\n      },\n\n      /**\n      * Get the related frame referenced in res\n      */\n      getRelatedFrame: function (res) {\n        var project = helpers.getRelatedProject(res);\n        return utils.findFirst(project.frames, res._frame_id);\n      },\n\n      /**\n       * Executes a function for each model\n       */\n      forEachModel: function(model, func) {\n        if(angular.isArray(model)){\n          angular.forEach(model, func);\n        }\n        else if(model){\n          func(model);\n        }\n      },\n\n      /**\n       * inject default values to a project\n       */\n      injectProjectDefaults: function(project) {\n        // Set default image if not set\n        if(!project.image){\n          project.image = 'assets/images/default-img.png';\n        }\n\n        // Default download url\n        if(!project.download_url){\n          project.download_url = apiUrl + '/v1/projects/' + project.id + '/download';\n        }\n      },\n\n      /**\n       * inject default values to a user\n       */\n      injectUserDefaults: function(user) {\n        return user;\n      },\n\n      /**\n       * Set a project as mine\n       */\n      setProjectAsMineSingle: function(project) {\n        if(!project.owner && models.current_user && models.current_user.id){\n          project.owner = { id: models.current_user.id };\n        }\n      },\n\n      /**\n       * Sort the frames and comments of a project by order\n       */\n      sortFramesAndCommentsSingle: function(project) {\n        utils.sortByOrder(project.frames);\n        angular.forEach(project.frames, function(frame) {\n          utils.sortByOrder(frame.comments);\n        });\n      },\n\n      humanizeProject: function(project) {\n        // force private to be a boolean (defaults to false), and set private string\n        project.private = !!project.private;\n        if(project.private){\n          project.privateString = 'Private Project';\n        }\n        else{\n          project.privateString = 'Public Project';\n        }\n      },\n\n      updateModelCache: function (modelCache, model) {\n        var newData = model;\n\n        // modelCache is array\n        if(angular.isArray(modelCache)){\n\n          // if model is array, recursion\n          if(angular.isArray(model)){\n            newData = [];\n            angular.forEach(model, function(m) {\n              if(m){\n                var merged = helpers.updateModelCache(modelCache, m); // recursion\n                if(merged){\n                  newData.push(merged);\n                }\n              }\n            });\n          }\n\n          // single model\n          else if(model){\n            // if model is marked as _reload, remove it from cache and add it again\n            if(model._reload){\n              utils.removeFirst(modelCache, model.id);\n              delete model._reload; // Delete _reload metadata not to store it in cache\n              newData = utils.mergeOrPush(modelCache, model);\n            }\n            // if model is marked as _destroyed, remove it from cache\n            else if(model._destroyed){\n              utils.removeFirst(modelCache, model.id);\n            }\n            // otherwise, just update the cache\n            else{\n              newData = utils.mergeOrPush(modelCache, model);\n            }\n          }\n        }\n\n        return newData;\n      }\n    };\n\n    return resPipe;\n  });\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * Long Term Memory\n   * Persist data to make it available after the browser is closed\n   */\n  .factory('longTermMemory', function () {\n\n    var longTermMemory = {\n      memorize: function(key, val) {\n        localStorage[key] = angular.toJson(val);\n      },\n\n      remember: function(key) {\n        try {\n          return angular.fromJson(localStorage[key]);\n        }\n        catch(e){\n          delete localStorage[key];\n          return null;\n        }\n      },\n\n      forget: function(key) {\n        delete localStorage[key];\n      },\n\n      oblivion: function() {\n        localStorage.clear();\n      }\n    };\n\n    return longTermMemory;\n  });\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * UI state service.\n   * Keep application-wide shared variables\n   */\n  .factory('galoreUploader', function (Upload, $q, utils, $timeout) {\n    var counter = 0;\n\n    var galoreUploader = {\n      files: [],\n      total: {},\n      upload: function(displayName, fileSize, obj) {\n        // Add an upload file object to the index\n        var uploadId = (counter++) + '';\n        galoreUploader.files.push({\n          id: uploadId,\n          status: 'queued',\n          name: displayName,\n          size: fileSize\n        });\n\n        helpers.updateTotal();\n\n        // Start upload\n        return Upload\n          .upload(obj)\n          .then(\n            // Response\n            function(response) {\n              var file = utils.findFirst(galoreUploader.files, uploadId);\n              file.status = 'success';\n              helpers.updateTotal();\n              $timeout(function() {\n                galoreUploader.dismiss(uploadId);\n              }, 5000);\n              return response;\n            },\n            // Error\n            function(err) {\n              var file = utils.findFirst(galoreUploader.files, uploadId);\n              file.status = 'error';\n              file.error = err;\n              helpers.updateTotal();\n              $timeout(function() {\n                galoreUploader.dismiss(uploadId);\n              }, 5000);\n              return $q.reject(err);\n            },\n            // Progress\n            function(evt) {\n              var file = utils.findFirst(galoreUploader.files, uploadId);\n              file.status = 'uploading';\n              file.loaded = evt.loaded;\n              file.size = evt.total;\n              file.percentage = parseInt(100.0 * evt.loaded / evt.total);\n              helpers.updateTotal();\n            }\n          );\n      },\n      dismiss: function(uploadId) {\n        var newFiles = [];\n        for (var i = 0; i < galoreUploader.files.length; i++) {\n          if(galoreUploader.files[i].id !== uploadId){\n            newFiles.push(galoreUploader.files[i]);\n          }\n        }\n        galoreUploader.files = newFiles;\n        helpers.updateTotal();\n      }\n    };\n\n    var helpers = {\n      updateTotal: function() {\n        galoreUploader.total.loaded = 0;\n        galoreUploader.total.size = 0;\n        galoreUploader.total.processing = 0;\n        galoreUploader.total.uploading = 0;\n        galoreUploader.total.canceled = 0;\n        galoreUploader.total.error = 0;\n        galoreUploader.total.success = 0;\n        galoreUploader.total.queued = 0;\n        angular.forEach(galoreUploader.files, function(file) {\n          switch(file.status){\n            case 'queued':\n              galoreUploader.total.queued++;\n              galoreUploader.total.size += file.size;\n              break;\n            case 'uploading':\n              galoreUploader.total.loaded += file.loaded;\n              galoreUploader.total.size += file.size;\n              galoreUploader.total.uploading++;\n              break;\n            case 'success':\n              galoreUploader.total.success++;\n              break;\n            case 'error':\n              galoreUploader.total.error++;\n              break;\n            case 'cancel':\n              galoreUploader.total.canceled++;\n              break;\n            default:\n              break;\n          }\n          galoreUploader.total.processing++;\n        });\n        galoreUploader.total.percentage = parseInt(100.0 * galoreUploader.total.loaded / galoreUploader.total.size);\n      }\n    };\n\n    helpers.updateTotal();\n\n    return galoreUploader;\n  });\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('galoreUploader', galoreUploaderDirective);\n\n  /** @ngInject */\n  function galoreUploaderDirective(galoreUploader) {\n    var directive = {\n      restrict: 'E',\n      link: linkFunc,\n      scope: {},\n      templateUrl: 'app/components/galoreUploader/galoreUploader.html'\n    };\n\n    return directive;\n\n    function linkFunc (scope) {\n      scope.expanded = false;\n      scope.uploader = galoreUploader;\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('galoreSidebar', galoreSidebar);\n\n  /** @ngInject */\n  function galoreSidebar($timeout) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/galoreSidebar/galoreSidebar.html',\n      controller: SidebarController,\n      controllerAs: 'sidebar',\n      link: SidebarLink,\n      bindToController: true,\n      replace: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function SidebarController(models, $state, units) {\n      var vm = this;\n\n      vm.models = models;\n      vm.state = $state;\n\n      vm.addUnit = function(level_id){\n\n        var unit_code;\n        var sub_unit_code;\n\n        var sortUnits = function(array){\n          array.sort(function(a, b){\n              var keyA = a.unit_code,\n                  keyB = b.unit_code;\n              if(keyA < keyB) return -1;\n              if(keyA > keyB) return 1;\n              return 0;\n          });\n          return array;\n        }\n\n        if(vm.models.levels.length > 0 ){\n\n          angular.forEach(vm.models.levels, function(value) {\n\n            if(value.id === level_id){\n              if(value.units.length > 0){\n                var units = sortUnits(value.units);\n                unit_code = units[units.length-1].unit_code;\n                sub_unit_code = units[units.length-1].sub_unit_code + 1;\n              }else{\n                unit_code = 1;\n                sub_unit_code = 1;\n              }\n              return;\n            }\n          });\n        }\n\n        vm.newUnit = {\n            \"level_id\": level_id,\n            \"title\": \"Unit \" + unit_code + \".\" + sub_unit_code,\n            \"unit_code\": unit_code,\n            \"sub_unit_code\": sub_unit_code\n        };\n\n        units\n            .create({unit:vm.newUnit});\n      }\n\n      vm.checkCurrentUnit = function(unit){\n        if(vm.models.current_unit && (vm.models.current_unit.id == unit.id)){\n          return 'levels current-unit';\n        }else{\n          return 'levels other-unit';\n        }\n      }\n      vm.checkCurrentLevel = function(level){\n        if(vm.models.current_unit && vm.models.current_unit.level_id == level.id){\n          return 'levels active';\n        }\n      }\n\n      vm.checkDashboard = function(){\n        if(vm.state.current.name === 'main.admin.dashboard'){\n          angular.element('.levels').removeClass('active');\n          return 'active';\n        }\n      }\n\n    }\n\n    function SidebarLink(){\n      $timeout(function () {\n        angular.element(window).trigger('resize'); // Trigger a resize event to adjust AdminLTE height\n      });\n\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('galoreHeader', galoreHeader);\n\n  /** @ngInject */\n  function galoreHeader($timeout) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/galoreHeader/galoreHeader.html',\n      controller: HeaderController,\n      controllerAs: 'header',\n      link: HeaderLink,\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function HeaderController(models) {\n      var vm = this;\n      vm.models = models;\n\n      vm.models.sidebar_mini = false;\n\n      vm.changeLevelsIcon = function(isCollapse){\n\n        if(isCollapse){\n          vm.models.sidebar_mini = true;\n        }else{\n          vm.models.sidebar_mini = false;\n        }\n      }\n\n\n    }\n\n    function HeaderLink(){\n\n      $timeout(function () {\n        angular.element(window).trigger('resize'); // Trigger a resize event to adjust AdminLTE height\n      });\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('galoreFooter', galoreFooter);\n\n  /** @ngInject */\n  function galoreFooter($timeout) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/galoreFooter/galoreFooter.html',\n      controller: FooterController,\n      controllerAs: 'footer',\n      link: FooterLink,\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function FooterController(models) {\n      var vm = this;\n\n      vm.models = models;\n    }\n\n    function FooterLink(){\n      $timeout(function () {\n        angular.element(window).trigger('resize'); // Trigger a resize event to adjust AdminLTE height\n      });\n    }\n  }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * My Project Overview API service\n   */\n   .factory('galoreApi', function (\n      $q,\n      $http,\n      $auth,\n      apiUrl,\n      unitApiUrl,\n      showLevelsApiUrl,\n      sectionApiUrl,\n      exercisesApiUrl,\n      resPipe\n    ) {\n      // Cache the promises (just to avoid to call the same API before the previous has finished)\n      var cache = {};\n\n      // Api Helpers (accessible only from this factory)\n      var helpers = {\n        /**\n         * Try to retrieve the result from cache, or make HTTP call\n         * @param  {String} method  The HTTP method\n         * @param  {String} url The API url\n         * @param  {Object} data    The body\n         * @param  {Object} headers The headers\n         * @param  {Boolean} keep   If true, the promise is cached even after it's been fulfilled\n         * @return {Promise}        A promise of the response\n         */\n        cacheOrHttp: function(method, url, data, headers, keep, absUrl) {\n          var key = method + url + (data ? angular.toJson(data) : '');\n          var config = {};\n          if(method) config.method = method.toUpperCase();\n          if(absUrl){\n            config.url = absUrl;\n          }else{\n            config.url = apiUrl + url;\n          }\n          if(data) config.data = data;\n          if(headers) config.headers = headers;\n\n\n          if (!cache[key]) {\n            var promise;\n            var err = false;\n            switch(method){\n              case 'get':\n              case 'GET':\n              case 'post':\n              case 'POST':\n              case 'put':\n              case 'PUT':\n              case 'patch':\n              case 'PATCH':\n              case 'delete':\n              case 'DELETE':\n                promise = $http(config);\n                break;\n              default:\n                err = true;\n                promise = $q.reject();\n                break;\n            }\n            if(!err){\n              cache[key] = promise.finally(function(response,err) {\n                if(!keep){\n                  delete cache[key]; // delete the cache, so the next call will be fresh\n                }\n                if(err) { return $q.reject(err); }\n                if(response) { return response; }\n              });\n            }\n          }\n\n          return cache[key];\n        },\n\n        uploadFileS3http: function(url, file_type, file){\n           return $http({\n             method: 'PUT',\n             url: url,\n             headers: {\n               'Content-Type': file_type,\n               'if-modified-since':undefined\n             },\n             data: file\n           })\n           .finally(function(response, err){\n            if(err) { return $q.reject(err); }\n            if(response) { return response; }\n           });\n        },\n\n\n        /**\n         * Expect a 200 response and return data.\n         * Otherwise, return a rejected promise.\n         */\n        expect200: function (response) {\n          if(response.status === 200){\n            return response.data;\n          }\n          else{\n            return $q.reject(response);\n          }\n        },\n\n        /**\n         * Expect a 201 response and return data.\n         * Otherwise, return a rejected promise.\n         */\n        expect201: function (response) {\n          if(response.status === 201){\n            return response.data;\n          }\n          else{\n            return $q.reject(response);\n          }\n        },\n\n        /**\n         * Expect a 204 response and return data.\n         * Otherwise, return a rejected promise.\n         */\n        expect204: function (response) {\n          if(response.status === 204){\n            return response.data;\n          }\n          else{\n            return $q.reject(response);\n          }\n        }\n      };\n\n      var galoreoApi = {\n        /** USER API **/\n\n        /**\n         * Authenticate the user\n         */\n        login: function(data) {\n          if(!cache.login){\n            cache.login = $auth\n              .submitLogin(data)\n              .finally(function(response,err) {\n                delete cache.login;\n                if(err) { return $q.reject(err); }\n                if(response) { return response; }\n              });\n          }\n          return cache.login;\n        },\n\n        /**\n         * Retrieve user data (together with role permissions)\n         */\n        getMe: function(){\n          return helpers\n            .cacheOrHttp('get', '/v1/me')\n            .then(helpers.expect200);\n        },\n\n        /**\n         * Logout the user\n         */\n        logout: function() {\n          if(!cache.logout){\n            cache.logout = $auth\n              .signOut()\n              .finally(function(response,err) {\n                delete cache.logout;\n                if(err) { return $q.reject(err); }\n                if(response) { return response; }\n              });\n          }\n          return cache.logout;\n        },\n\n        /**\n        * Change the password of the user\n        */\n        changePassword: function (data) {\n          if(!cache.changePassword){\n            cache.changePassword = $auth\n              .updatePassword(data)\n              .finally(function (response, err) {\n                  delete cache.changePassword;\n                  if(err) { return $q.reject(err); }\n                  if(response) { return response; }\n              });\n          }\n          return cache.changePassword;\n        },\n\n        /**\n        * Create Unit\n        */\n        createUnit: function(data) {\n          return helpers\n          .cacheOrHttp('post', unitApiUrl, data)\n          .then(helpers.expect201);\n        },\n\n        /**\n         * Destroy unit\n         */\n        destroyUnit: function (unit) {\n          return helpers\n            .cacheOrHttp('delete', unitApiUrl + '/' + unit.id)\n            .then(helpers.expect204)\n            .then(function(){\n              return {unit: unit};\n            });\n        },\n\n        /**\n         * Destroy exercise\n         */\n        destroyExercise: function (exercise) {\n\n          return helpers\n            .cacheOrHttp('delete', exercisesApiUrl + '/' + exercise.id)\n            .then(helpers.expect204)\n            .then(function(){\n              return {exercise: exercise};\n            });\n        },\n\n        /**\n        * Destroy a file audio\n        */\n        deleteFileAudio: function(section, file_id) {\n          return helpers\n            .cacheOrHttp('delete', sectionApiUrl + 'b/audio_items/' + section.id + '/' + file_id)\n            .then(helpers.expect204)\n            .then(function(){\n              return {section: section};\n            });\n        },\n\n\n        /**\n        * Create Exercise\n        */\n        createExercise: function(data) {\n          return helpers\n          .cacheOrHttp('post', exercisesApiUrl, data)\n          .then(helpers.expect201);\n        },\n\n        /**\n        * Create Exercise with image\n        */\n        createExerciseImage: function(id_exercise, data) {\n          return helpers\n          .cacheOrHttp('post', exercisesApiUrl + '/' + id_exercise + '/exercise_image_text_items', data)\n          .then(helpers.expect201);\n        },\n\n        /**\n        * Create a new file audio\n        */\n        createFileAudio: function(section_id, data) {\n          return helpers\n          .cacheOrHttp('post', sectionApiUrl +'b/' + section_id + '/audio_items', data)\n          .then(helpers.expect201);\n        },\n\n        /**\n        * Show Unit\n        */\n        showUnit: function(id) {\n          return helpers\n          .cacheOrHttp('get', unitApiUrl + '/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get Section A by id section\n        */\n        getSectionA: function(id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + 'a/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get Section B by id section\n        */\n        getSectionB: function(id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + 'b/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get Section C by id section\n        */\n        getSectionC: function(id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + 'c/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get Section D by id section\n        */\n        getSectionD: function(id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + 'd/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get Section E by id section\n        */\n        getSectionE: function(id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + 'e/' + id)\n          .then(helpers.expect200);\n        },\n\n        /**\n        * Get excercises by id section\n        */\n        getExercises: function(section, id){\n          return helpers\n          .cacheOrHttp('get', sectionApiUrl + section + '/' + id + '/exercises')\n          .then(helpers.expect200);\n        },\n\n        /**\n         * Show all levels\n         */\n        indexLevels: function(){\n          return helpers\n            .cacheOrHttp('get', showLevelsApiUrl)\n            .then(helpers.expect200);\n        },\n\n\n       /**\n        * Update unit\n        */\n        updateUnit: function(id, data){\n          return helpers\n            .cacheOrHttp('put', unitApiUrl + '/' + id, data)\n            .then(helpers.expect200);\n        },\n\n        /**\n         * Update section\n         */\n         updateSection: function(section, id, data){\n           return helpers\n             .cacheOrHttp('put', sectionApiUrl + section + '/' + id, data)\n             .then(resPipe.log)\n             .then(helpers.expect200);\n         },\n\n         /**\n          * Update excercise\n          */\n          updateExercise: function(id, data){\n            return helpers\n              .cacheOrHttp('put', exercisesApiUrl + '/' + id, data)\n              .then(helpers.expect200);\n          },\n\n         /**\n         * Upload Video\n         */\n         uploadVideo: function(section, section_id, data){\n           return helpers\n             .cacheOrHttp('post', sectionApiUrl + section + '/' + section_id + '/video_upload', data)\n             .then(helpers.expect200);\n         },\n\n         /**\n         * Upload Video S3\n         */\n         uploadFileS3: function(url, file_type, file){\n           return helpers\n             .uploadFileS3http(url, file_type, file)\n             .then(helpers.expect200);\n         },\n\n         /**\n         * Upload generic file\n         */\n         uploadFile: function(exercise_id, exercise_item_id, data){\n           return helpers\n             .cacheOrHttp('post', exercisesApiUrl  + '/' + exercise_id + '/exercise_image_text_items/' + exercise_item_id + '/image_upload', data)\n             .then(helpers.expect200);\n         },\n\n         /**\n         * Upload file\n         */\n         uploadFileAudio: function(section_id, audio_id, data){\n           return helpers\n             .cacheOrHttp('post', sectionApiUrl  + 'b/' + section_id + '/audio_items/' + audio_id + '/audio_upload', data)\n             .then(helpers.expect200);\n         },\n\n         /**\n         * Upload Image tip\n         */\n         uploadImageTip: function(section, section_id, type_of_tip, data){\n           return helpers\n             .cacheOrHttp('post', sectionApiUrl + section + '/' + section_id + '/' + type_of_tip, data)\n             .then(helpers.expect200);\n         },\n\n         uploadImageTipExercise: function(exercise_id, data){\n           return helpers\n             .cacheOrHttp('post', exercisesApiUrl + '/' + exercise_id + '/exercise_tips_image_upload', data)\n             .then(helpers.expect200);\n         },\n\n         /**\n         * Publish current unit\n         */\n         publishUnit: function(id){\n           return helpers\n             .cacheOrHttp('post', unitApiUrl + '/' + id +'/publish')\n             .then(helpers.expect204);\n         },\n\n         /**\n         * unpublish current unit\n         */\n         unpublishUnit: function(id){\n           return helpers\n             .cacheOrHttp('post', unitApiUrl + '/' + id +'/unpublish')\n             .then(helpers.expect204);\n         }\n      };\n\n      return galoreoApi;\n   });\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('exerciseTextText', exerciseTextText);\n\n    /** @ngInject */\n    function exerciseTextText(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/exerciseTextText/exerciseTextText.html',\n        controller: exerciseTextTextController,\n        controllerAs: 'exerciseTextText',\n        bindToController: true,\n        scope:{\n          model: '=',\n          idEx: '='\n        }\n      };\n\n      return directive;\n\n      /** @ngInject */\n      function exerciseTextTextController(models, $scope) {\n        var vm = this;\n        vm.models = models;\n\n        vm.addRow = function(){\n          if(!vm.model){\n              vm.model = [];\n          }\n          var newRow = angular.copy(vm.exercise_text_text_item);\n          vm.model.push(newRow);\n          vm.exercise_text_text_item.item_number = \"\";\n          vm.exercise_text_text_item.text_it = \"\";\n          vm.exercise_text_text_item.text_en = \"\";\n        }\n\n\n        $scope.$watch('exerciseTextText.model', function (newVal, oldVal) {\n            if(newVal !== oldVal) {\n              vm.form = angular.copy(vm.model);\n            }\n        });\n      }\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('exerciseImageText', exerciseImageText);\n\n    /** @ngInject */\n    function exerciseImageText(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/exerciseImageText/exerciseImageText.html',\n        controller: exerciseImageTextController,\n        controllerAs: 'exerciseImageText',\n        bindToController: true,\n        scope:{\n          model: '=',\n          idex: '='\n        }\n      };\n\n      return directive;\n\n      /** @ngInject */\n      function exerciseImageTextController(models, $scope) {\n        var vm = this;\n        vm.models = models;\n\n        vm.addRow = function(){\n          if(!vm.model){\n            vm.model = [];\n          }\n          var newRow = angular.copy(vm.exercise_image_text_item);\n          if(vm.exercise_image_text_item.image){\n            newRow.image = vm.exercise_image_text_item.image;\n          }\n          vm.model.push(newRow);\n          vm.exercise_image_text_item.image = {};\n          vm.exercise_image_text_item.item_number = \"\";\n          vm.exercise_image_text_item.text_en = \"\";\n        }\n\n        vm.uploadImageFile = function($file){\n          vm.exercise_image_text_item.image = {'file' : $file};\n        };\n\n        vm.changeImageFile = function($file, row){\n          row.image = {'file' : $file};\n        };\n\n        $scope.$watch('exerciseImageText.model', function (newVal, oldVal) {\n            if(newVal !== oldVal) {\n              vm.form = angular.copy(vm.model);\n            }\n        });\n\n      }\n    }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('exercise', exercise);\n\n  /** @ngInject */\n  function exercise() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/exercise/exercise.html',\n      controller: TabExerciseController,\n      controllerAs: 'exercise',\n      bindToController: true,\n      scope:{\n        model: '=',\n        section: '@',\n        currentsection: '=',\n        tabinfo: '@'\n      }\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function TabExerciseController(models, $state, units, $q, $timeout) {\n      var vm = this;\n      vm.models = models;\n\n      vm.data = {\n         availableOptions: [\n             {id: 1 , name: 'Dropdown'},\n             {id: 2 , name: 'Completamento'},\n             {id: 3 , name: 'Trova lintruso'},\n             {id: 4 , name: 'Riordina la parola'},\n             {id: 5 , name: 'Riordina le frasi'},\n             {id: 6 , name: 'Connetti immagine/frase'},\n             {id: 7 , name: 'Connetti frase/frase'},\n             {id: 8 , name: 'Vero o Falso'},\n             {id: 9 , name: 'Memory'}\n          ],\n         selectedOption: {id: 1, name: 'Dropdown'}\n      };\n\n      vm.setLoading = function (res) {\n        vm.loading = true;\n        return $q.resolve(res);\n      }\n\n      vm.unsetLoading = function (res) {\n        vm.loading = false;\n        return $q.resolve(res);\n      }\n\n      vm.uploadImageTipFile = function($file){\n        vm.form.image_tip = $file;\n        vm.form.exercise_tips_image_filename = $file.name;\n      }\n\n      vm.submitImageTip = function(id){\n        var exercise_tips_image_url = \"\";\n        var exercise_tips_image_filename = \"\";\n        return units\n          .uploadImageTipExercise(id, { filename: vm.form.image_tip.name, type: vm.form.image_tip.type })\n          .then(function(res) {\n            exercise_tips_image_filename = res.exercise_tips_image_filename;\n            exercise_tips_image_url = res.exercise_tips_image_url;\n            return units.uploadFileS3(res.upload_url, vm.form.image_tip.type, vm.form.image_tip)\n          })\n          .then(function(){\n            vm.form.exercise_tips_image_url = exercise_tips_image_url;\n            vm.form.exercise_tips_image_filename = exercise_tips_image_filename;\n            vm.model.exercise_tips_image_url = exercise_tips_image_url;\n            vm.model.exercise_tips_image_filename = exercise_tips_image_filename;\n            delete vm.form.image_tip;\n\n            return units.updateExercise(vm.form.id,  {'exercise':vm.form});\n          });\n      }\n\n      vm.submit = function () {\n\n        vm.form.unit_section_id = vm.model.id;\n        vm.form.unit_section_type = vm.section;\n        vm.form.exercise_type = vm.form.exercise_type.id;\n\n        delete vm.form.exercise_text_text;\n        delete vm.form.exercise_image_text;\n        delete vm.form.exercise_text;\n\n        return vm.setLoading()\n          .then(function(){\n            return units.createExercise({'exercise': vm.form});\n           })\n          .then(function(res){\n            vm.form.id = res.exercise.id;\n\n            if(vm.form.image_tip && vm.form.image_tip.name){\n              return vm.submitImageTip(vm.form.id);\n            }\n          })\n          .then(function(){\n            vm.currentsection.push(angular.copy(vm.form));\n            vm.models.activeTabIndex = 0;\n            vm.form.exercise_tips = \"\";\n            vm.form.title = \"\";\n            vm.form.subtitle = \"\";\n            vm.form.exercise_type = {id: 1, name: 'Dropdown'};\n\n              $timeout(function () {\n                vm.unsetLoading();\n                if(vm.section === 'UnitSectionD'){\n                  angular.element(\"#sectionD .tab-pane\").removeClass('active in');\n                  angular.element(\"#sectionD #info\").addClass('active in');\n                }\n                else if(vm.section === 'UnitSectionE'){\n                  angular.element(\"#sectionE .tab-pane\").removeClass('active in');\n                  angular.element(\"#sectionE #info\").addClass('active in');\n                }\n                angular.element(vm.tabinfo).tab('show');\n              }, 100);\n          })\n          .finally(function(){\n            vm.unsetLoading();\n          });\n      }\n    }\n\n  }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * Error Manager.\n   * Handles common HTTP error messages\n   */\n  .factory('errorManager', function (toastr, $log, $state, $q, longTermMemory, models) {\n    var errorManager = function(err) {\n      // log every errors\n      $log.error(err);\n\n      // Unwrap HTTP errors and take actions if needed\n      if(angular.isObject(err) && err.status){\n        switch(err.status){\n          case 401:\n            $state.go('main.logout');\n            err = err.data;\n            break;\n          case 403:\n            $state.go('main.home');\n            err = err.data;\n            break;\n          case 422:\n            err = err.data;\n            break;\n          case 404:\n            err = err.data;\n            break;\n          case 413:\n            err = 'Il file che stai cercando di caricare  troppo grande';\n            break;\n          case -1:\n            err = 'Il server non  raggiungibile o non sei connesso ad Internet';\n            break;\n          default:\n            break;\n        }\n      }\n\n      var getErrorString = function (err) {\n        if(angular.isString(err)){\n          return err;\n        }\n        else if(angular.isObject(err) && (err.full_messages || err.error_description || err.errors || err.data || err.msg || err.error)){\n          return getErrorString(err.full_messages || err.error_description || err.errors || err.data || err.msg || err.error );\n        }\n        else if(angular.isArray(err)){\n          var myErr = [];\n          for (var i = 0; i < err.length; i++) {\n            myErr[i] = getErrorString(err[i]);\n          }\n          return getErrorString(myErr.join('<br>'));\n        }\n        // Don't manage different kinds of error\n        else{\n          longTermMemory.oblivion(); // Forget everything. We don't want the app to be broken forever!\n          models.reset(); // Reset all the models. We don't want the app to be broken forever!\n          return 'Si  verificato un errore imprevisto. Si prega di riprovare pi tardi.';\n        }\n      }\n\n      toastr.error(getErrorString(err), 'Errore');\n\n      return $q.reject(err);\n    };\n\n    return errorManager;\n  });\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('ckeditorStandard', ckeditorStandard);\n\n    /** @ngInject */\n    function ckeditorStandard(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/ckeditorColor/ckeditorColor.html',\n        controller: CkEditorStandardController,\n        controllerAs: 'ckeditorColor',\n        bindToController: true,\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n\n\n      /** @ngInject */\n      function CkEditorStandardController(models, $scope) {\n\n        var vm = this;\n        vm.models = models;\n\n        $scope.options = {\n            language: 'it',\n            allowedContent: true,\n            entities: false,\n            toolbar: 'Full',\n            colorButton_colors: '337ab7,cf4555,00a65a,ffeb3b',\n            colorButton_enableMore: false,\n            colorButton_enableAutomatic: false,\n            toolbar_Full:[\n              { name: 'document', items : [ 'Source','-','Save'] },\n              { name: 'tools', items : [ 'Maximize'] },\n              { name: 'clipboard', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },\n              { name: 'basicstyles', items : [ 'Bold','Italic','Underline','Strike','Subscript','Superscript','-','RemoveFormat' ] },\n              { name: 'paragraph', items : ['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock','-'] }\n            ]\n          };\n\n      }\n    }\n\n})();\n\n(function(){\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('ckeditorColor', ckeditorColor);\n\n    /** @ngInject */\n    function ckeditorColor(){\n      var directive = {\n        restrict: 'E',\n        templateUrl: 'app/components/ckeditorColor/ckeditorColor.html',\n        controller: CkEditorColorController,\n        controllerAs: 'ckeditorColor',\n        bindToController: true,\n        scope:{\n          model: '='\n        }\n      };\n\n      return directive;\n\n\n      /** @ngInject */\n      function CkEditorColorController(models, $scope) {\n\n        var vm = this;\n        vm.models = models;\n\n        $scope.options = {\n            language: 'it',\n            allowedContent: true,\n            entities: false,\n            toolbar: 'Full',\n            // colorButton_colors: '337ab7,cf4555,00a65a,ffeb3b',\n            // colorButton_enableMore: false,\n            // colorButton_enableAutomatic: false,\n            toolbar_Full:[\n              { name: 'document', items : [ 'Source','-','Save'] },\n              { name: 'tools', items : [ 'Maximize'] },\n              { name: 'clipboard', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },\n              { name: 'basicstyles', items : [ 'Bold','Italic','Underline','Strike','Subscript','Superscript','-','RemoveFormat' ] },\n              { name: 'paragraph', items : [ 'NumberedList','BulletedList','-','Outdent','Indent','-','Blockquote',\n              '-','JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock','-'] },\n              { name: 'links', items : [ 'Link','Unlink'] },\n              { name: 'insert', items : ['Table'] },\n              { name: 'colors', items : [ 'TextColor'] }\n            ]\n          };\n\n      }\n    }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * My Project Overview API service\n   */\n   .factory('can', function (models) {\n\n      var helpers = {\n        instanceCondition: function(action, resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          // Safely get condition function (avoiding undefined errors)\n          var cond = perms && perms.instanceConditions && perms.instanceConditions[action] && perms.instanceConditions[action][resource];\n          // If no condition was found, return true, else evaluate the condition\n          return !cond || cond(instance);\n        },\n        canManage: function(resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          return !!perms && !!perms.manage && (perms.manage.indexOf(resource) >= 0) && helpers.instanceCondition('manage', resource, instance);\n        },\n        canUpdate: function(resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          return !!perms && !!perms.update && (perms.update.indexOf(resource) >= 0) && helpers.instanceCondition('update', resource, instance);\n        },\n        canShow: function(resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          return !!perms && !!perms.show && (perms.show.indexOf(resource) >= 0) && helpers.instanceCondition('show', resource, instance);\n        },\n        canIndex: function(resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          return !!perms && !!perms.index && (perms.index.indexOf(resource) >= 0) && helpers.instanceCondition('index', resource, instance);\n        },\n        customCan: function(action, resource, instance) {\n          var perms = models.current_user && models.current_user.can;\n          return !!perms && !!perms[action] && (perms[action].indexOf(resource) >= 0) && helpers.instanceCondition(action, resource, instance);\n        }\n      };\n\n      var can = function(action, resource, instance){\n        switch(action){\n          case 'manage':\n            return helpers.canManage(resource, instance);\n          case 'update':\n            return helpers.canManage(resource, instance) || helpers.canUpdate(resource, instance);\n          case 'show':\n            return helpers.canManage(resource, instance) || helpers.canUpdate(resource, instance) || helpers.canShow(resource, instance);\n          case 'index':\n            return helpers.canShow(resource, instance) || helpers.canIndex(resource, instance);\n          default:\n            return helpers.customCan(action, resource, instance);\n        }\n      };\n\n      return can;\n   });\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('can', canDirective);\n\n  /** @ngInject */\n  function canDirective(can, $log, models) {\n    var directive = {\n      restrict: 'A',\n      link: linkFunc,\n      scope: {\n        instance: '='\n      }\n    };\n\n    return directive;\n\n    function linkFunc(scope, el, attr) {\n      var watcher;\n      var shown;\n      var action;\n      var resource;\n      var negative;\n      scope.models = models;\n\n      // Update the visibility of the element\n      var updateVisibility = function() {\n        var toShow = can(action, resource, scope.instance);\n        if(negative){ toShow = !toShow; } // invert the condition if needed\n        // Show the element if not shown\n        if(toShow && !shown){\n          el.removeClass('can-hide');\n          shown = true;\n        }\n\n        // Hide the element if shown\n        else if(!toShow && shown){\n          el.addClass('can-hide');\n          shown = false;\n        }\n      };\n\n      // Parse can attribute\n      var parsed = attr.can.split(':');\n      if(parsed.length !== 2){\n        $log.error('Syntax error in \"can\" directive: ' + angular.toJson(attr.can));\n        return;\n      }\n\n      // If the action starts with \"!\", the action is negative\n      negative = parsed[0].slice(0, 1) === '!';\n\n\n      // In that case, remove ! from the string\n      if(negative){\n        parsed[0] = parsed[0].substr(1);\n      }\n\n      // Extract the action and the resource\n      action = parsed[0];\n      resource = parsed[1];\n\n      // Update the visibility for the first time\n      shown = true;\n      updateVisibility();\n\n      // Update the visibility as soon as the permissions change\n      watcher = scope.$watch('models.current_user.can', function(newVal, oldVal) {\n        if(newVal && oldVal !== newVal){\n          updateVisibility();\n        }\n      });\n\n      // Update the visibility as soon as the instance changes\n      watcher = scope.$watch('instance', function(newVal, oldVal) {\n        if(newVal && oldVal !== newVal){\n          updateVisibility();\n        }\n      });\n\n      scope.$on('$destroy', function () {\n        watcher();\n      });\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .directive('boxExpander', boxExpander);\n\n  /** @ngInject */\n  function boxExpander() {\n    var directive = {\n      restrict: 'A',\n      scope: {\n        boxExpander: '='\n      },\n      link: boxExpanderLink\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function boxExpanderLink(scope, el) {\n      el.addClass(\"panel-collapse collapse\");\n\n      scope.$watch('boxExpander', function (newVal, oldVal) {\n        if(newVal !== oldVal){\n          if(newVal){\n            //el.collapse('show');\n          }else{\n            el.collapse('hide');\n          }\n        }\n      })\n    }\n  }\n\n})();\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * My user Overview API service\n   */\n   .factory('users', function (galoreApi, errorManager, resPipe, models) {\n\n      var users = {\n\n        /**\n         * Get current user\n         */\n        me: function(){\n          return galoreApi\n            .getMe()\n            .then(resPipe.parseResponse)\n            .then(resPipe.updateCache)\n            .then(resPipe.updateCurrent)\n            .then(resPipe.memorizeCache)\n            .catch(errorManager);\n        },\n\n        /**\n        * Update current user\n        */\n        updateMe: function (data) {\n          return galoreApi\n            .updateMe(data)\n            .then(function (res) {\n              if(res.status === \"success\")\n              {\n                return {\n                  user: res.data\n                }\n              }\n              return res;\n            })\n            .then(resPipe.parseResponse)\n            .then(resPipe.injectDefaults)\n            .then(helpers.addInstanceConditions)\n            .then(resPipe.updateCache)\n            .then(resPipe.updateCurrent)\n            .then(resPipe.memorizeCache)\n            .catch(errorManager);\n        }\n      };\n\n      var helpers = {\n        addInstanceConditions: function(res) {\n          if(res.user){\n            res.user.can.instanceConditions = models.getInstanceConditions();\n          }\n          return res;\n        }\n      };\n\n      return users;\n   });\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * My Project Overview API service\n   */\n   .factory('units', function (galoreApi, resPipe, utils, errorManager, $q) {\n      var units = {\n\n        /**\n         * get a unit from server (given id)\n         */\n        show: function(id){\n          return galoreApi\n            .showUnit(id)                     // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * create a new unit\n         */\n        create: function(data){\n          return galoreApi\n            .createUnit(data)\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.injectDefaults)     // Inject some defatult values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * create a new exercise\n         */\n        createExercise: function(data){\n          return galoreApi\n            .createExercise(data)\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.injectDefaults)     // Inject some defatult values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n\n        /**\n         * create a new exercise with image\n         */\n        createExerciseImage: function(id, data){\n          return galoreApi\n            .createExerciseImage(id, data)\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.injectDefaults)     // Inject some defatult values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * create a new file audio\n         */\n        createFileAudio: function(id, data){\n          return galoreApi\n            .createFileAudio(id, data)\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.injectDefaults)     // Inject some defatult values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get sectionA by level id\n        */\n        getSectionA: function(id){\n          return galoreApi\n            .getSectionA(id)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get sectionB by level id\n        */\n        getSectionB: function(id){\n          return galoreApi\n            .getSectionB(id)                   // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get sectionC by level id\n        */\n        getSectionC: function(id){\n          return galoreApi\n            .getSectionC(id)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get sectionD by level id\n        */\n        getSectionD: function(id){\n          return galoreApi\n            .getSectionD(id)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get sectionE by level id\n        */\n        getSectionE: function(id){\n          return galoreApi\n            .getSectionE(id)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n        * Get excercises by section id\n        */\n        getExercises: function(section, id){\n          return galoreApi\n            .getExercises(section, id)         // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markReload)         // Mark the unit as to be reloaded\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * update unit\n         */\n        update: function(id, data){\n\n          return galoreApi\n            .updateUnit(id, data)             // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current project\n            .then(resPipe.memorizeCache)      // Memorize projects in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * update section\n         */\n        updateSection: function(section, id, data){\n          return galoreApi\n            .updateSection(section, id, data) // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current project\n            .then(resPipe.memorizeCache)      // Memorize projects in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * update exercise exercise_id, exercise_item_id, data\n         */\n        updateExercise: function(exercise_id, data){\n          var uploadPromises = [];\n          if(angular.isArray(data.exercise.exercise_image_text_items)){\n            angular.forEach(data.exercise.exercise_image_text_items, function(item){\n              if(item.image && item.image.file){\n                var promise = units\n                  .uploadFile(exercise_id, item.id, {\n                    filename: item.image.file.name,\n                    type: item.image.file.type\n                  })\n                  .then(function(res){\n                    item.temp_url = res.image_url;\n                    item.file_name = res.image_filename;\n                    return units\n                      .uploadFileS3(res.upload_url, item.image.file.type, item.image.file)\n                      .then(function(){\n                        item.image_filename = item.file_name;\n                        item.image_url = item.temp_url;\n                        delete item.image;\n                        delete item.file_name;\n                        delete item.temp_url;\n                      });\n                  });\n                uploadPromises.push(promise);\n              }\n            });\n          }\n\n          return $q\n            .all(uploadPromises)\n            .then(function(){\n              return galoreApi.updateExercise(exercise_id, data)\n            })\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.humanize)           // Perform conversions between raw values and user friendly values\n            .then(resPipe.updateCache)        // Update the cache\n            .then(resPipe.updateCurrent)       // Set as current project\n            .then(resPipe.memorizeCache)      // Memorize projects in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        /*\n        * Publish current unit\n        */\n        publishUnit: function(id){\n          return galoreApi\n            .publishUnit(id)\n            .catch(errorManager);\n        },\n\n        /*\n        * Unpublish current unit\n        */\n        unpublishUnit: function(id){\n          return galoreApi\n            .unpublishUnit(id)\n            .catch(errorManager);\n        },\n\n        uploadVideo: function(section, section_id, data){\n          return galoreApi\n            .uploadVideo(section, section_id, data) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        uploadFile: function(exercise_id, exercise_item_id, data){\n          return galoreApi\n            .uploadFile(exercise_id, exercise_item_id, data) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        uploadFileAudio: function(section_id, file_id, data){\n          return galoreApi\n            .uploadFileAudio(section_id, file_id, data) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        uploadImageTip: function(section, section_id, type_of_tip, data){\n          return galoreApi\n            .uploadImageTip(section, section_id, type_of_tip, data) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        uploadImageTipExercise: function(exercise_id, data){\n          return galoreApi\n            .uploadImageTipExercise(exercise_id, data) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        uploadFileS3 :function(url, file_type, file){\n          return galoreApi\n            .uploadFileS3(url, file_type, file) // API call\n            .catch(errorManager);             // Handle errors\n        },\n\n        /**\n         * destroy a unit\n         */\n        destroyUnit: function(unit){\n          return galoreApi\n            .destroyUnit(unit)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markDestroyed)      // Mark the unit as destroyed\n            .then(resPipe.updateCache)        // Update cache\n            .then(resPipe.updateCurrent)        // Update current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n\n        /**\n         * destroy an exercise\n         */\n        destroyExercise: function(exercise){\n          return galoreApi\n            .destroyExercise(exercise)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markDestroyed)      // Mark the unit as destroyed\n            .then(resPipe.updateCache)        // Update cache\n            .then(resPipe.updateCurrent)        // Update current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        },\n\n        deleteFileAudio: function(section, file_id){\n          return galoreApi\n            .deleteFileAudio(section, file_id)                  // API call\n            .then(resPipe.parseResponse)      // Parse the raw response\n            .then(resPipe.markDestroyed)      // Mark the unit as destroyed\n            .then(resPipe.updateCache)        // Update cache\n            .then(resPipe.updateCurrent)        // Update current\n            .then(resPipe.memorizeCache)      // Memorize units in local storage\n            .catch(errorManager);             // Handle errors\n        }\n\n\n\n\n      };\n\n      return units;\n   });\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n  * Models cache\n  */\n  .factory('models', function (longTermMemory) {\n\n    var models = {\n       reset: function () {\n         models.levels = longTermMemory.remember('levels') || [];\n         models.current_unit = longTermMemory.remember('current_unit') || [];\n         // models.aboutProjects = longTermMemory.remember('aboutProjects') || [];\n         models.current_user = longTermMemory.remember('current_user') || undefined;\n       }\n    };\n\n    models.reset();\n\n    return models;\n  });\n\n'use strict';\n\nangular.module('englishGalore')\n  /**\n   * My Project Overview API service\n   */\n   .factory('levels', function (galoreApi, resPipe, utils, errorManager) {\n      var levels = {\n\n        /**\n         * List of levels\n         */\n        index: function(){\n          return galoreApi\n            .indexLevels()                // API call\n            .then(resPipe.log)\n            .then(resPipe.parseResponse)    // Parse the raw response\n            .then(resPipe.log)\n            .then(resPipe.injectDefaults)   // Inject some defatult values\n            .then(resPipe.log)\n            .then(resPipe.updateCache)      // Update the cache\n            .then(resPipe.log)\n            .then(resPipe.memorizeCache) // Memorize projects in local storage\n            .catch(errorManager);           // Handle errors\n        }\n      };\n\n      return levels;\n   });\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log,\n    $rootScope,\n    uiState,\n    defaultBodyClasses,\n    longTermMemory\n    ) {\n        // Bind the uiState to $rootScope as it's used in index.html\n        $rootScope.uiState = uiState;\n\n        // On state change\n        var stateChangeSuccess = $rootScope.$on('$stateChangeSuccess', function (event, toState) {\n          var pms = toState.params || {};\n          uiState.bodyClasses = pms.bodyClasses || defaultBodyClasses;\n        });\n\n        // Destroy watchers\n        $rootScope.$on('$destroy', function() {\n          stateChangeSuccess();\n        });\n\n        longTermMemory.oblivion();\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n\n    $stateProvider\n      .state('main', {\n        abstract: true,\n        templateUrl: 'app/pages/main/main.html'\n      })\n      .state('main.admin', {\n        templateUrl: 'app/pages/admin/admin.html',\n        controller: 'AdminController',\n        controllerAs: 'vm',\n        resolve: {\n          currentUser: function($auth, $q, users) {\n            return $auth\n              .validateUser()\n              .then(function(res){\n                if(res.signedIn !== true){\n                  return $q.reject();\n                }\n              })\n              .then(users.me)\n              .catch(function(){\n                return null;\n              });\n          },\n          levelsData: function(levels){\n            return levels.index();\n          }\n        },\n        onEnter: function($timeout, $state, levelsData, currentUser){\n          if(!currentUser){\n            $timeout(function(){\n              $state.go('main.login');\n            });\n          }\n        }\n      })\n      .state('main.logout', {\n        url: '/logout',\n        onEnter: function($q, errorManager, galoreApi, $state, toastr, models, longTermMemory) {\n          galoreApi.logout()\n            .finally(function() {\n              delete models.current_user;\n              models.users = [];\n              longTermMemory.forget('user');\n              longTermMemory.forget('current_user');\n              $state.go('main.login');\n            });\n        }\n      })\n      .state('main.login', {\n        url: '/login',\n        templateUrl: 'app/pages/login/login.html',\n        controller: 'LoginController',\n        controllerAs: 'vm',\n        params: {\n          bodyClasses: 'hold-transition login-page'\n        }\n      })\n      .state('main.admin.unit', {\n        url: '/units/:id',\n        templateUrl: 'app/pages/unit/unit.html',\n        controller: 'UnitController',\n        controllerAs: 'vm'\n      })\n      .state('main.admin.profile', {\n        url: '/profile',\n        templateUrl: 'app/pages/profile/profile.html',\n        controller: 'ProfileController',\n        controllerAs: 'vm'\n      })\n      .state('main.admin.dashboard', {\n        url: '/',\n        templateUrl: 'app/pages/dashboard/dashboard.html',\n        controller: 'DashboardController',\n        controllerAs: 'vm'\n      })\n      .state('main.admin.createUnit', {\n        url: '/create-unit',\n        templateUrl: 'app/pages/createUnit/createUnit.html',\n        controller: 'CreateUnitController',\n        controllerAs: 'vm'\n      })\n      .state('main.admin.faq', {\n        url: '/faq',\n        templateUrl: 'app/pages/faq/faq.html',\n        controller: 'FaqController',\n        controllerAs: 'vm'\n      })\n      .state('main.admin.category', {\n        url: '/faq/category',\n        templateUrl: 'app/pages/faq/category/category.html',\n        controller: 'CategoryController',\n        controllerAs: 'vm'\n      })\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .constant('apiUrl', 'http://eg-api.tandu.it')\n    .constant('defaultBodyClasses', 'skin-purple-light sidebar-mini')\n    .constant('unitApiUrl', '/v1/units')\n    .constant('showLevelsApiUrl', '/v1/levels')\n    .constant('sectionApiUrl', '/v1/unit_sections_')\n    .constant('exercisesApiUrl', '/v1/exercises')\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('englishGalore')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig, $animateProvider, $locationProvider, $provide, $authProvider, apiUrl) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Animate only elements with class \"animate\"\n    $animateProvider.classNameFilter(/animate/);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 3000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = false;\n    toastrConfig.progressBar = false;\n\n    //Removes '#' from the URL\n    $locationProvider.html5Mode(true);\n    $locationProvider.hashPrefix('!');\n\n    $authProvider.configure({\n      apiUrl:                  apiUrl,\n      tokenValidationPath:     '/v1/auth/validate_token',\n      signOutUrl:              '/v1/auth/logout',\n      emailRegistrationPath:   '/v1/auth/register',\n      accountDeletePath:       '/v1/auth/delete_account',\n      passwordResetPath:       '/v1/auth/password',\n      passwordUpdatePath:      '/v1/auth/password',\n      passwordResetSuccessUrl: window.location.origin, //eslint-disable-line\n      emailSignInPath:         '/v1/auth/login'\n    });\n  }\n\n})();\n\nangular.module(\"englishGalore\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/ckeditorColor/ckeditorColor.html\",\"<div ckeditor=options ng-model=ckeditorColor.model ready=onReady()></div>\");\n$templateCache.put(\"app/components/exercise/exercise.html\",\"<div class=exercise><form name=formExercise ng-submit=exercise.submit() ng-model=exercise.form><div class=row><div class=col-sm-6><div class=from-group><label>Numero Esercizio</label><select ng-init=\\\"exercise.form.exercise_number = exercise.model.exercise_ids.length + 1\\\" ng-model=exercise.form.exercise_number class=form-control ng-options=\\\"n for n in [] | range:1:6\\\" required></select></div></div><div class=col-sm-6><div class=form-group><label>Tipologia Esercizio</label><select ng-init=\\\"exercise.form.exercise_type = exercise.data.selectedOption\\\" ng-model=exercise.form.exercise_type class=form-control ng-options=\\\"option.name for option in exercise.data.availableOptions track by option.id\\\" required></select></div></div></div><div class=row><div class=col-sm-6><div class=form-group ng-class=\\\"\\\"><label>Titolo Esercizio</label><input ng-model=exercise.form.title type=text class=form-control placeholder=\\\"Inserisci il titolo dell\\'esercizio\\\" required></div></div><div class=col-sm-6><div class=form-group ng-class=\\\"\\\"><label>Sottotitolo Esercizio</label><input ng-model=exercise.form.subtitle type=text class=form-control placeholder=\\\"Inserisci il sottotitolo dell\\'esercizio\\\" required></div></div></div><div class=row><div class=col-sm-6><div class=form-group><label for=\\\"\\\">Tip Esercizio</label><ckeditor-color model=exercise.form.exercise_tips></ckeditor-color><div class=separator></div><a ngf-select=exercise.uploadImageTipFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=exercise.form.image_tip><label><i class=\\\"fa fa-upload\\\"></i> Carica Immagine del Tip</label></a><div ng-if=exercise.form.image_tip.name class=url-video-box><span>Immagine: </span>{{exercise.form.image_tip.name}}<br></div></div></div></div><div class=row><div class=col-sm-12><input type=submit class=\\\"btn btn-success pull-right\\\" value=\\\"Crea Esercizio\\\"></div></div></form><div ng-show=exercise.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></div>\");\n$templateCache.put(\"app/components/exerciseImageText/exerciseImageText.html\",\"<div class=separator></div><div class=col-sm-12><p><strong>Connetti immagine/frase</strong></p></div><div class=col-sm-12><table class=\\\"table table-responsive\\\"><tbody><tr><th>Ordine</th><th>Immagine</th><th>Frase</th><th></th></tr><tr><td width=80px><div class=form-group><input ng-model=exerciseImageText.exercise_image_text_item.item_number name=item_number type=number class=form-control></div></td><td ng-init=\\\"exerciseImageText.exercise_image_text_item.image = {}\\\"><a ngf-select=exerciseImageText.uploadImageFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=exerciseImageText.exercise_image_text_item.image><label><i class=\\\"fa fa-upload\\\"></i> Upload image</label></a><br><span ng-if=exerciseImageText.exercise_image_text_item.image.file.name>Immagine: {{exerciseImageText.exercise_image_text_item.image.file.name}}</span></td><td><div class=form-group><input ng-model=exerciseImageText.exercise_image_text_item.text_en name=text_en type=text class=form-control placeholder=\\\"Inserisci la frase\\\"></div></td><td width=93px><div class=pull-right><a role=button class=\\\"btn btn-sm btn-default accordion-toggle\\\" data-toggle=collapse ng-click=exerciseImageText.addRow()><i class=\\\"fa fa-plus\\\" aria-hidden=true></i></a></div></td></tr><tr ng-repeat-start=\\\"row in exerciseImageText.model | orderBy:\\'item_number\\'\\\" ng-if=\\\"row._destroy == false || !row._destroy\\\"><td>{{row.item_number}}</td><td><a href={{row.image_url}} target=_blank ng-if=\\\"row.image_url && !row.image.file.name\\\">{{row.image_filename}} </a><span ng-if=row.image.file.name>{{row.image.file.name}}</span></td><td>{{row.text_en}}</td><td><div class=\\\"pull-right opacity-transition\\\"><a role=button class=\\\"btn btn-sm btn-default accordion-toggle\\\" data-toggle=collapse data-target=#open-row-{{exerciseImageText.idex}}-{{$index}}><i class=\\\"fa fa-pencil\\\"></i> </a><a role=button class=\\\"btn btn-sm btn-danger\\\" ng-click=\\\"row._destroy=true\\\"><i class=\\\"fa fa-trash\\\"></i></a></div></td></tr><tr ng-repeat-end class=\\\"collapse background-gray\\\" id=open-row-{{exerciseImageText.idex}}-{{$index}}><td colspan=8><div class=col-md-2><div class=form-group><label>Modifica Ordine</label><input ng-model=row.item_number name=item_number type=number class=form-control></div></div><div class=col-md-4><label>Modifica Immagine</label><br><span><a ngf-select=\\\"exerciseImageText.changeImageFile($file, row)\\\" ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=row.image><label><i class=\\\"fa fa-upload\\\"></i> Upload image</label></a></span><br><a href={{row.image_url}} target=_blank ng-if=\\\"row.image_url && !row.image.file.name\\\">{{row.image_filename}} </a><span ng-if=row.image.file.name>{{row.image.file.name}}</span></div><div class=col-md-6><div class=form-group><label>Modifica Frase</label><input ng-model=row.text_en name=text_en type=text class=form-control placeholder=\\\"Inserisci la frase\\\"></div></div></td></tr></tbody></table></div>\");\n$templateCache.put(\"app/components/exerciseTextText/exerciseTextText.html\",\"<div class=separator></div><div class=col-sm-12><p><strong>Connetti frase/frase</strong></p></div><div class=col-sm-12><table class=\\\"table table-responsive\\\"><tbody><tr><th>Ordine</th><th>Frase in Italiano</th><th>Traduzione in Inglese</th><th></th></tr><tr><td width=80px><div class=form-group><input ng-model=exerciseTextText.exercise_text_text_item.item_number name=item_number type=number class=form-control></div></td><td><div class=form-group><input ng-model=exerciseTextText.exercise_text_text_item.text_it name=text_it type=text class=form-control placeholder=\\\"Inserisci la frase in italiano\\\"></div></td><td><div class=form-group><input ng-model=exerciseTextText.exercise_text_text_item.text_en name=text_en type=text class=form-control placeholder=\\\"Inserisci la traduzione in inglese\\\"></div></td><td class=text-center width=93px><a role=button class=\\\"btn btn-sm btn-default accordion-toggle pull-right\\\" data-toggle=collapse ng-click=exerciseTextText.addRow()><i class=\\\"fa fa-plus\\\" aria-hidden=true></i></a></td></tr><tr ng-repeat-start=\\\"row in exerciseTextText.model | orderBy:\\'item_number\\'\\\" ng-if=\\\"row._destroy == false || !row._destroy\\\"><td>{{row.item_number}}</td><td>{{row.text_it}}</td><td>{{row.text_en}}</td><td><div class=\\\"pull-right opacity-transition\\\"><a role=button class=\\\"btn btn-sm btn-default accordion-toggle\\\" data-toggle=collapse data-target=#open-text-row-{{exerciseTextText.idEx}}-{{$index}}><i class=\\\"fa fa-pencil\\\"></i> </a><a role=button class=\\\"btn btn-sm btn-danger\\\" ng-click=\\\"row._destroy=true\\\"><i class=\\\"fa fa-trash\\\"></i></a></div></td></tr><tr ng-repeat-end class=\\\"collapse background-gray\\\" id=open-text-row-{{exerciseTextText.idEx}}-{{$index}}><td colspan=8><div class=col-md-2><div class=form-group><label>Modifica Ordine</label><input ng-model=row.item_number name=item_number type=number class=form-control></div></div><div class=col-md-4><label>Modifica Frase in Italiano</label><input ng-model=row.text_it name=text_it type=text class=form-control placeholder=\\\"Inserisci la frase in italiano\\\"></div><div class=col-md-6><div class=form-group><label>Modifica Frase in Inglese</label><input ng-model=row.text_en name=text_en type=text class=form-control placeholder=\\\"Inserisci la traduzione in inglese\\\"></div></div></td></tr></tbody></table></div>\");\n$templateCache.put(\"app/components/galoreFooter/galoreFooter.html\",\"<footer class=main-footer><div class=\\\"pull-right hidden-xs\\\"><b>Version</b> 1.0.0</div><strong>Copyright  2016-2017 <a href=#>English Galore</a>.</strong> All rights reserved.</footer>\");\n$templateCache.put(\"app/components/galoreHeader/galoreHeader.html\",\"<header class=\\\"main-header galore-header\\\"><a ui-sref=main.admin.dashboard class=logo><!-- mini logo for sidebar mini 50x50 pixels --> <span class=logo-mini><img src=/assets/images/logo-sm.png></span><!-- logo for regular state and mobile devices --> <span class=logo-lg><img src=/assets/images/logo.png></span></a><nav class=\\\"navbar navbar-static-top\\\" role=navigation><!-- Sidebar toggle button--> <a href=# class=sidebar-toggle data-toggle=offcanvas role=button ng-click=\\\"isCollapse = !isCollapse; header.changeLevelsIcon(isCollapse)\\\"><span class=sr-only>Toggle navigation</span> </a><!-- Navbar Right Menu --><div class=navbar-custom-menu><ul class=\\\"nav navbar-nav\\\"><li class=\\\"dropdown user user-menu\\\"><a href=# class=dropdown-toggle data-toggle=dropdown aria-expanded=false><span class=hidden-xs>{{ header.models.current_user.firstName }} {{ header.models.current_user.lastName }}</span></a><ul class=dropdown-menu><!-- User image --><li class=user-header><img src=\\\"{{ header.models.current_user.image || \\'/assets/images/logo-sm.png\\' }}\\\" ng-class=\\\"{\\'default-user-img\\': !header.models.current_user.image}\\\" class=img-circle alt=\\\"User Image\\\"><p>{{ header.models.current_user.email }}</p></li><!-- Menu Footer--><li class=user-footer><div class=pull-left><a ui-sref=main.admin.profile class=\\\"btn btn-default btn-flat\\\">Profilo</a></div><div class=pull-right><a ui-sref=main.logout class=\\\"btn btn-default btn-flat\\\">Esci</a></div></li></ul></li></ul></div></nav></header>\");\n$templateCache.put(\"app/components/galoreSidebar/galoreSidebar.html\",\"<div class=main-sidebar><!-- Inner sidebar --><div class=sidebar><!-- Sidebar Menu --><ul class=sidebar-menu><!-- SECTION Main Menu --><li class=header>Main Menu</li><!-- Home --><li class=treeview ng-class=sidebar.checkDashboard()><a ui-sref=main.admin.dashboard><i class=\\\"fa fa-dashboard\\\" aria-hidden=true></i> <span>Dashboard</span></a></li><!-- !Home --><!-- SECTION Livelli --><li ng-repeat=\\\"level in sidebar.models.levels | orderBy:\\'title\\'\\\" ng-class=sidebar.checkCurrentLevel(level)><a href=#><i ng-show=\\\"!sidebar.models.sidebar_mini || sidebar.models.sidebar_mini == false\\\" class=\\\"fa fa-circle\\\"></i><div ng-show=\\\"sidebar.models.sidebar_mini == true\\\">{{level.title}}</div><span>Livello {{level.title}}</span> <span class=pull-right-container><i class=\\\"fa fa-angle-left\\\"></i></span></a><ul class=treeview-menu><!-- Visualizza Unit --><li ng-repeat=\\\"unit in level.units | orderBy:[\\'unit_code\\',\\'sub_unit_code\\',\\'title\\']\\\" ng-class=sidebar.checkCurrentUnit(unit)><a id={{unit.id}} ui-sref=\\\"main.admin.unit({id: unit.id})\\\" ng-class=\\\"{\\'title-pubblicata\\': {{unit.published}} == true, \\'\\': {{unit.published}} == false}\\\"><i ng-class=\\\"{\\'fa fa-circle-o title-pubblicata\\': {{unit.published}} == true, \\'fa fa-circle-o\\':{{unit.published}} == false}\\\"></i> Unit {{unit.unit_code}}.{{unit.sub_unit_code}} - {{ unit.title }}</a></li><!-- Aggiungi Unit --><li ng-class=\\\"{active: sidebar.state.current.name === \\'main.admin.createUnit\\'}\\\"><a ng-click=sidebar.addUnit(level.id)><i class=\\\"fa fa-plus\\\"></i> Aggiungi unit</a></li></ul></li><!-- !SECTION Livelli --><!-- SECTION Support --><li class=header>Admin</li><!-- Users --><li class=treeview ng-class=\\\"{active: sidebar.state.current.name === \\'main.admin.documentation\\'}\\\"><a ui-sref=main.admin.documentation><i class=\\\"fa fa-users\\\" aria-hidden=true></i> <span>Utenti</span></a></li><!-- !Users --><!-- Glossario --><li class=treeview ng-class=\\\"{active: sidebar.state.current.name === \\'main.admin.glossario\\'}\\\"><a ui-sref=main.admin.documentation><i class=\\\"fa fa-book\\\" aria-hidden=true></i> <span>Glossario</span></a></li><!-- !Glossario --><!-- Faq --><li class=treeview ng-class=\\\"{active: sidebar.state.current.name === \\'main.admin.faq\\'}\\\"><a href=#><i class=\\\"fa fa-comments-o\\\" aria-hidden=true></i> <span>Faq</span> <span class=pull-right-container><i class=\\\"fa fa-angle-left\\\"></i></span></a><ul class=treeview-menu><li><a ui-sref=main.admin.category role=button><i class=\\\"fa fa-circle-o\\\"></i> Categorie</a></li><li><a ui-sref=main.admin.faq><i class=\\\"fa fa-circle-o\\\"></i> Tutte le Faq</a></li><li ng-class=\\\"\\\"><a ng-click=\\\"\\\"><i class=\\\"fa fa-plus\\\"></i> Aggiungi Faq</a></li></ul></li><!-- !Faq --><!-- !SECTION Support --></ul><!-- /.sidebar-menu --></div><!-- /.sidebar --></div><!-- /.main-sidebar -->\");\n$templateCache.put(\"app/components/galoreUploader/galoreUploader.html\",\"<div class=galore-uploader ng-show=\\\"uploader.total.processing > 0\\\"><div class=summary ng-click=\\\"expanded = !expanded\\\"><i ng-class=\\\"{\\'fa-chevron-down\\': expanded, \\'fa-chevron-up\\': !expanded}\\\" class=fa></i> Processing {{ uploader.total.processing }} files: <span ng-show=uploader.total.queued>{{ uploader.total.queued }} queued </span><span ng-show=uploader.total.uploading>{{ uploader.total.uploading }} uploading </span><span ng-show=uploader.total.canceled>{{ uploader.total.canceled }} canceled </span><span ng-show=uploader.total.error>{{ uploader.total.error }} errors </span><span ng-show=uploader.total.success>{{ uploader.total.success }} done</span><div class=progress ng-show=\\\"!expanded && uploader.total.size > 0\\\"><div class=\\\"progress-bar progress-bar-striped progress-bar-primary active\\\" role=progressbar aria-valuenow=\\\"{{ uploader.total.percentage }}\\\" aria-valuemin=0 aria-valuemax=100 style=\\\"width: {{ uploader.total.percentage }}%\\\"></div></div></div><div class=details ng-show=expanded><div ng-repeat=\\\"file in uploader.files\\\"><div class=file-details>{{ file.name }} <i class=\\\"status-icon {{ file.status }}\\\"></i><div class=progress ng-show=\\\"file.status === \\'uploading\\'\\\"><div class=\\\"progress-bar progress-bar-striped progress-bar-primary active\\\" role=progressbar aria-valuenow=\\\"{{ file.percentage }}\\\" aria-valuemin=0 aria-valuemax=100 style=\\\"width: {{ file.percentage }}%\\\"></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionA/sectionA.html\",\"<div class=row><div class=col-xs-12><div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a data-toggle=collapse data-target=#intro aria-expanded=false class=\\\"collapsed title-active\\\" role=button ng-click=\\\"isCollapsed = !isCollapsed\\\"><h4 class=box-title>A) {{sectionA.form.section_label}} <i ng-class=\\\"{\\'fa fa-angle-down\\': !isCollapsed, \\'fa fa-angle-up\\': isCollapsed}\\\" aria-hidden=true></i></h4></a></div><div id=intro box-expander=sectionA.form><div class=box-body><div class=row><div class=col-xs-12><form id=formIntroVideo name=formIntroVideo ng-submit=sectionA.submit() ng-model=sectionA.form novalidate><div class=nav-tabs-custom><ul class=\\\"nav nav-tabs\\\"><li class=active><a data-target=#sec_a_tab_video data-toggle=tab aria-expanded=false role=button>Video</a></li></ul><div class=tab-content><div class=\\\"tab-pane tab-big active\\\" id=sec_a_tab_video><tab-video model=sectionA.form></tab-video></div><!-- /.tab-pane --></div><!-- /.tab-content --><div class=pull-right><input type=submit class=\\\"btn btn-success\\\" value=\\\"Salva Sezione\\\"></div></div><!-- nav-tabs-custom --><div ng-show=sectionA.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></form></div></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionB/infoPopoverTemplate.html\",\"<div class=info-popover><p class=info-popover-title>Regole di inserimento</p><ul><li>I <strong>nomi dei personaggi</strong> devono essere contenuti tra i caratteri <strong>@</strong><br><span class=popover-example>es. @Pietro@</span></li><li>Le <strong>traduzioni</strong> devono essere tra parentesi quadre <strong>[...]</strong><br><span class=popover-example>es.[Chi  alla porta?]</span></li><li>Bisogna caricare <strong>un file audio per ogni pezzo di dialogo.</strong><br>Il nome del file audio associato alla porzione di dialogo <strong>va specificato dopo la fine del dialogo</strong> e devono essere contenuti tra i caratteri <strong>/</strong> <span class=popover-example>es. /1.1-r1.mp3/</span></li><li>Usare il carattere <strong>#</strong> per le <strong>frasi che non sono associate ad un personaggio</strong></li></ul></div>\");\n$templateCache.put(\"app/components/sectionB/sectionB.html\",\"<div class=row><div class=col-xs-12><div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a ng-class=\\\"{\\'title-active\\': sectionB.form.active}\\\" data-toggle=collapse role=button data-target=#sectionB aria-expanded=false class=collapsed ng-click=\\\"isCollapsed = !isCollapsed\\\"><h4 class=box-title>B) {{sectionB.form.section_label}} <i ng-class=\\\"{\\'fa fa-angle-down\\': !isCollapsed, \\'fa fa-angle-up\\': isCollapsed}\\\" aria-hidden=true></i></h4></a><div class=pull-right><label class=switch ng-click=sectionB.changeStatusSection();$event.stopPropagation();><input type=checkbox ng-model=sectionB.form.active><div class=\\\"slider round\\\"></div></label></div></div><div id=sectionB box-expander=sectionB.form.active><div class=box-body><div class=row><div class=col-xs-12><form id=formIntroVideo name=formIntroVideo ng-submit=sectionB.submit() ng-model=sectionB.form novalidate><div class=nav-tabs-custom><ul class=\\\"nav nav-tabs\\\"><li class=active><a role=button data-target=#sec_b_tab_info data-toggle=tab aria-expanded=true>Info</a></li><li><a role=button data-target=#sec_b_tab_dialogo data-toggle=tab aria-expanded=false>Dialogo</a></li></ul><div class=tab-content><div class=\\\"tab-pane active\\\" id=sec_b_tab_info><tab-info-section model=sectionB.form></tab-info-section></div><div class=clear></div><!-- /.tab-pane --><div class=tab-pane id=sec_b_tab_dialogo><tab-dialogue model=sectionB.form></tab-dialogue><div class=separator></div></div><div class=clear></div><!-- /.tab-pane --></div><!-- /.tab-content --><div class=pull-right><input type=submit class=\\\"btn btn-success\\\" value=\\\"Salva Sezione\\\"></div></div><!-- nav-tabs-custom --></form><div ng-show=sectionB.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></div></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionC/sectionC.html\",\"<div class=\\\"row sectionC\\\"><div class=col-xs-12><div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a ng-class=\\\"{\\'title-active\\': sectionC.form.active}\\\" data-toggle=collapse role=button data-target=#sectionC aria-expanded=false class=collapsed ng-click=\\\"isCollapsed = !isCollapsed; sectionC.getExercises(isCollapsed)\\\"><h4 class=box-title>C) {{sectionC.form.section_label}} <i ng-class=\\\"{\\'fa fa-angle-down\\': !isCollapsed, \\'fa fa-angle-up\\': isCollapsed}\\\" aria-hidden=true></i></h4></a><div class=pull-right><label class=switch ng-click=$event.stopPropagation();><input type=checkbox ng-model=sectionC.form.active><div class=\\\"slider round\\\"></div></label></div></div><div id=sectionC box-expander=sectionC.form.active><div class=box-body><div class=row><div class=col-xs-12><div class=nav-tabs-custom><ul class=\\\"nav nav-tabs\\\"><li class=active role=button><a data-target=#info-tab-c id=tab-c role=tab data-toggle=tab aria-expanded=false role=button>Info</a></li><li class=dropdown role=button><a data-target=# class=dropdown-toggle id=exercise-drop data-toggle=dropdown aria-controls=exercise-drop-contents aria-expanded=true role=button>Esercizi <span class=\\\"fa fa-angle-down\\\"></span></a><ul class=dropdown-menu aria-labelledby=exercise-drop id=exercise-drop-contents><li role=button><a data-target=#addExercise role=tab id=addExercise-tab data-toggle=tab aria-controls=addExercise aria-expanded=true><span class=\\\"fa fa-plus\\\"></span> Aggiungi esercizio</a></li><li ng-repeat=\\\"row in sectionC.models.current_unit_sections_c_exercises.exercises | orderBy:\\'exercise_number\\'\\\" id=row_{{row.id}} ng-if=\\\"row._destroyed == false || !row._destroyed\\\" role=button><a data-target=#ex-{{row.id}} id=ex-tab-{{row.id}} role=tab data-toggle=tab aria-controls=ex-{{row.id}}>{{row.title}}</a></li></ul></li></ul><div class=tab-content><div class=\\\"tab-pane active\\\" role=tabpanel id=info-tab-c><form id=formIntroVideo name=formIntroVideo ng-submit=sectionC.submit() novalidate><div class=row><tab-info-section model=sectionC.form></tab-info-section></div><input type=submit class=\\\"btn btn-success btn-save-section\\\" value=\\\"Salva Sezione\\\"></form></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=addExercise aria-labelledby=addExercise-tab><exercise model=sectionC.form section=UnitSectionC currentsection=sectionC.models.current_unit_sections_c_exercises.exercises tabinfo=\\\"#sectionC #tab-c\\\"></exercise></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=ex-{{rowC.id}} ng-repeat=\\\"rowC in sectionC.models.current_unit_sections_c_exercises.exercises | orderBy:\\'exercise_number\\'\\\"><exercise-show model=rowC section=UnitSectionC currentsection=sectionC.models.current_unit_sections_c_exercises.exercises section=UnitSectionC currenttab=#ex-tab-{{rowC.id}} tabinfo=#tab-c></exercise-show></div></div><div ng-show=sectionC.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div><!-- /.tab-content --></div><!-- nav-tabs-custom --></div></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionD/sectionD.html\",\"<div class=row><div class=col-xs-12><div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a ng-class=\\\"{\\'title-active\\': sectionD.form.active}\\\" data-toggle=collapse role=button data-target=#sectionD aria-expanded=false class=collapsed ng-click=\\\"isCollapsed = !isCollapsed; sectionD.getExercises(isCollapsed);\\\"><h4 class=box-title>D) {{sectionD.form.section_label}} <i ng-class=\\\"{\\'fa fa-angle-down\\': !isCollapsed, \\'fa fa-angle-up\\': isCollapsed}\\\" aria-hidden=true></i></h4></a><div class=pull-right><label class=switch ng-click=$event.stopPropagation();><input type=checkbox ng-model=sectionD.form.active><div class=\\\"slider round\\\"></div></label></div></div><div id=sectionD box-expander=sectionD.form.active><div class=box-body><div class=row><div class=col-xs-12><div class=nav-tabs-custom><div ng-model=sectionD.form novalidate><ul class=\\\"nav nav-tabs\\\"><li class=active role=button><a data-target=#info-tab-d id=tab-d role=tab data-toggle=tab aria-expanded=false role=button>Info</a></li><li role=button><a data-target=#theory role=tab data-toggle=tab aria-expanded=false role=button>Teoria</a></li><li role=button><a data-target=#text role=tab data-toggle=tab aria-expanded=false role=button>Testo Approfondimento</a></li><li role=button><a data-target=#video role=tab data-toggle=tab aria-expanded=false role=button>Video Approfondimento</a></li><li class=dropdown role=button><a data-target=# class=dropdown-toggle id=exercise-drop-d data-toggle=dropdown aria-controls=exercise-drop-d-contents aria-expanded=true role=button>Esercizi <span class=\\\"fa fa-angle-down\\\"></span></a><ul class=dropdown-menu aria-labelledby=exercise-drop-d id=exercise-drop-d-contents><li role=button><a data-target=#addExerciseD role=tab id=addExerciseD-tab data-toggle=tab aria-controls=addExerciseD aria-expanded=true><span class=\\\"fa fa-plus\\\"></span> Aggiungi esercizio</a></li><li ng-repeat=\\\"row in sectionD.models.current_unit_sections_d_exercises.exercises | orderBy:\\'exercise_number\\'\\\" id=row_{{row.id}} ng-if=\\\"row._destroyed == false || !row._destroyed\\\" role=button><a data-target=#ex-{{row.id}} id=ex-tab-{{row.id}} role=tab data-toggle=tab aria-controls=ex-{row.id}}>{{row.title}}</a></li></ul></li></ul><div class=tab-content><div class=\\\"tab-pane active\\\" role=tabpanel id=info-tab-d><tab-info-section model=sectionD.form></tab-info-section></div><div class=tab-pane role=tabpanel id=theory><tab-theory model=sectionD.form></tab-theory></div><div class=tab-pane role=tabpanel id=text><tab-theory-in-depth model=sectionD.form></tab-theory-in-depth></div><div class=tab-pane role=tabpanel id=video><tab-video model=sectionD.form></tab-video></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=addExerciseD aria-labelledby=addExerciseD-tab><exercise model=sectionD.form section=UnitSectionD currentsection=sectionD.models.current_unit_sections_d_exercises.exercises tabinfo=#tab-d></exercise></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=ex-{{rowD.id}} ng-repeat=\\\"rowD in sectionD.models.current_unit_sections_d_exercises.exercises | orderBy:\\'exercise_number\\'\\\"><exercise-show model=rowD section=UnitSectionD currentsection=sectionD.models.current_unit_sections_d_exercises.exercises section=UnitSectionD currenttab=#ex-tab-{{rowD.id}} tabinfo=#tab-d></exercise-show></div></div></div><!-- /.tab-content --><div class=separator></div><div class=pull-right><div class=separator></div><input type=button class=\\\"btn btn-success\\\" value=\\\"Salva Sezione\\\" ng-click=sectionD.submit()></div><div ng-show=sectionD.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></div><!-- nav-tabs-custom --></div></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionE/sectionE.html\",\"<div class=\\\"row sectionE\\\"><div class=col-xs-12><div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a ng-class=\\\"{\\'title-active\\': sectionE.form.active}\\\" data-toggle=collapse role=button data-target=#sectionE aria-expanded=false class=collapsed ng-click=\\\"isCollapsed = !isCollapsed; sectionE.getExercises(isCollapsed)\\\"><h4 class=box-title>E) {{sectionE.form.section_label}} <i ng-class=\\\"{\\'fa fa-angle-down\\': !isCollapsed, \\'fa fa-angle-up\\': isCollapsed}\\\" aria-hidden=true></i></h4></a><div class=pull-right><label class=switch ng-click=$event.stopPropagation();><input type=checkbox ng-model=sectionE.form.active><div class=\\\"slider round\\\"></div></label></div></div><div id=sectionE box-expander=sectionE.form.active><div class=box-body><div class=row><div class=col-xs-12><div class=nav-tabs-custom><ul class=\\\"nav nav-tabs\\\"><li class=active role=button><a data-target=#info-tab-e id=tab-e role=tab data-toggle=tab aria-expanded=false role=button>Info</a></li><li class=dropdown role=button><a data-target=# class=dropdown-toggle id=exercise-drop-e data-toggle=dropdown aria-controls=exercise-drop-e-contents aria-expanded=true role=button>Esercizi <span class=\\\"fa fa-angle-down\\\"></span></a><ul class=dropdown-menu aria-labelledby=exercise-drop-e id=exercise-drop-e-contents><li role=button><a data-target=#addExerciseE role=tab id=addExerciseE-tab data-toggle=tab aria-controls=addExerciseE aria-expanded=true><span class=\\\"fa fa-plus\\\"></span> Aggiungi esercizio</a></li><li ng-repeat=\\\"row in sectionE.models.current_unit_sections_e_exercises.exercises | orderBy:\\'exercise_number\\'\\\" id=row_{{row.id}} ng-if=\\\"row._destroyed == false || !row._destroyed\\\" role=button><a data-target=#ex-{{row.id}} id=ex-tab-{{row.id}} role=tab data-toggle=tab aria-controls=ex-{{row.id}}>{{row.title}}</a></li></ul></li></ul><div class=tab-content><div class=\\\"tab-pane active\\\" role=tabpanel id=info-tab-e><form id=formIntroVideo name=formIntroVideo ng-submit=sectionE.submit() novalidate><div class=row><tab-info-section model=sectionE.form></tab-info-section></div><input type=submit class=\\\"btn btn-success btn-save-section\\\" value=\\\"Salva Sezione\\\"></form></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=addExerciseE aria-labelledby=addExerciseE-tab><exercise model=sectionE.form section=UnitSectionE currentsection=sectionE.models.current_unit_sections_e_exercises.exercises tabinfo=\\\"#sectionE #tab-e\\\"></exercise></div><div class=\\\"tab-pane fade\\\" role=tabpanel id=ex-{{rowE.id}} ng-repeat=\\\"rowE in sectionE.models.current_unit_sections_e_exercises.exercises | orderBy:\\'exercise_number\\'\\\"><exercise-show model=rowE section=UnitSectionE currentsection=sectionE.models.current_unit_sections_e_exercises.exercises section=UnitSectionE currenttab=#ex-tab-{{rowE.id}} tabinfo=#tab-e></exercise-show></div><div ng-show=sectionE.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></div><!-- /.tab-content --></div><!-- nav-tabs-custom --></div></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/sectionUnit/sectionUnit.html\",\"<div class=\\\"panel box panel-box-red\\\"><div class=\\\"box-header with-border\\\"><a data-toggle=collapse data-target=#sectionUnit aria-expanded=false class=\\\"collapsed title-active\\\" role=button ng-click=\\\"isCollapsed = !isCollapsed\\\"><h4 class=box-title>Info Unit <i ng-class=\\\"{\\'fa fa-angle-up\\': !isCollapsed, \\'fa fa-angle-down\\': isCollapsed}\\\" aria-hidden=true></i></h4></a></div><div id=sectionUnit box-expander=sectionUnit.form class=\\\"panel-collapse collapse in\\\"><div class=box-body><form id=formIntroVideo name=formIntroVideo ng-submit=sectionUnit.submit(sectionUnit.form.id) ng-model=sectionUnit.form novalidate><div class=row id=tab_intro><div class=col-sm-6><div class=form-group><label>Codice Unit</label><input name=unit_code ng-model=sectionUnit.form.unit_code type=number class=form-control placeholder=\\\"Inserisci il codice dell\\'unit\\\"><!-- <select\\n                    name = \\\"unit_code\\\"\\n                    ng-model=\\\"sectionUnit.form.unit_code\\\"\\n                    class=\\\"form-control\\\"\\n                    ng-options=\\\"n for n in [] | range:1:21\\\"\\n                  >\\n                  </select> --></div></div><div class=col-sm-6><div class=form-group><label>Sotto Codice Unit</label><!-- <select\\n                    name = \\\"sub_unit_code\\\"\\n                    ng-model=\\\"sectionUnit.form.sub_unit_code\\\"\\n                    class=\\\"form-control\\\"\\n                    ng-options=\\\"n for n in [] | range:1:21\\\"\\n                  >\\n                  </select> --> <input name=sub_unit_code ng-model=sectionUnit.form.sub_unit_code type=number class=form-control placeholder=\\\"Inserisci il sotto codice dell\\'unit\\\"></div></div><div class=col-sm-6><div class=form-group><label for=\\\"\\\">Titolo Unit</label><input name=title ng-model=sectionUnit.form.title type=text class=form-control placeholder=\\\"Inserisci il titolo dell\\'unit\\\"></div></div></div><div class=row><div class=col-xs-12><input type=submit class=\\\"btn btn-default pull-right btn-blue\\\" value=\\\"Salva Info Unit\\\"> <input type=button ng-click=sectionUnit.destroy(sectionUnit.form.id) class=\\\"btn btn-success pull-right btn-red\\\" value=\\\"Elimina Unit\\\"></div></div><div ng-show=sectionUnit.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></form></div></div></div>\");\n$templateCache.put(\"app/components/tabDialogue/tabDialogue.html\",\"<div class=col-sm-12><a ngf-select=tabDialogue.uploadAudioFile($files) ngf-multiple=true ngf-allow-dir=false class=upload-video-label instance=tabDialogue.model.files_audio><label><i class=\\\"fa fa-upload\\\"></i> Carica File Audio</label></a><div class=files-audio><ul class=list-inline><li ng-repeat=\\\"file in tabDialogue.model.files_audio | orderBy:\\'file.name\\'\\\" ng-if=!file._destroy>{{file.name}} <span ng-click=\\\"tabDialogue.removeFile(file, $index)\\\"><i class=\\\"fa fa-trash\\\"></i></span></li></ul></div><div class=files-audio ng-if=\\\"tabDialogue.model.audio_items.length > 0\\\">File Audio:<ul class=list-inline ng-init=\\\"tabDialogue.model.audio_items_temp = tabDialogue.model.audio_items\\\"><li ng-repeat=\\\"file in tabDialogue.model.audio_items_temp | orderBy:\\'file.name\\'\\\" ng-if=!file._destroy><a href={{file.audio_url}} target=_blank>{{file.audio_filename}}</a> <span ng-click=\\\"tabDialogue.removeFile(file, $index)\\\"><i class=\\\"fa fa-trash\\\"></i></span></li></ul></div></div><div class=separator></div><div class=col-sm-12><div class=form-group ng-class=\\\"\\\"><label for=\\\"\\\">Testo dialogo</label><button uib-popover-template=dynamicPopover.templateUrl type=button class=\\\"btn btn-default pull-right btn-popover-info\\\" popover-placement=right><i class=\\\"fa fa-info-circle\\\" aria-hidden=true></i></button><textarea rows=4 cols=50 ng-model=tabDialogue.model.dialogue name=dialogue type=text class=\\\"form-control textarea-dialogue\\\" placeholder=\\\"Inserisci il testo del dialogo\\\">\\n    </textarea></div></div><div class=separator></div><div class=col-sm-12><label for=\\\"\\\">Tip Dialogo</label><ckeditor-color model=tabDialogue.model.dialogue_tips></ckeditor-color><div class=separator></div><a ngf-select=tabDialogue.uploadImageTipFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=tabDialogue.model.image_tip><label><i class=\\\"fa fa-upload\\\"></i> Carica Immagine del Tip</label></a><div ng-if=\\\"tabDialogue.model.dialogue_tips_image_url && !tabDialogue.model.image_tip.name\\\" class=url-video-box><span>Immagine: </span><a href={{tabDialogue.model.dialogue_tips_image_url}} target=_blank>{{tabDialogue.model.dialogue_tips_image_filename}}</a><br></div><div ng-if=tabDialogue.model.image_tip.name class=url-video-box><span>Immagine: </span>{{tabDialogue.model.image_tip.name}}<br></div></div>\");\n$templateCache.put(\"app/components/tabInfoSection/tabInfoSection.html\",\"<div class=col-sm-6><div class=\\\"form-group has-feedback\\\"><label for=\\\"\\\">Titolo Sessione</label><input ng-model=model.title name=\\\"\\\" type=text class=form-control placeholder=\\\"Inserisci il titolo della sessione\\\"></div></div>\");\n$templateCache.put(\"app/components/tabTheory/tabTheory.html\",\"<div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"\\\"><label>Titolo</label><input ng-model=tabTheory.model.theory_title name=\\\"\\\" type=text class=form-control placeholder=\\\"Inserisci il titolo\\\" required><span ng-show=\\\"formIntroVideo[\\'name\\' + ($index+1)].$dirty\\\" ng-messages=\\\"formIntroVideo[\\'name\\' + ($index+1)].$error\\\" class=help-block role=alert><span ng-message=required>Questo campo  obbligatorio</span></span></div></div><div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"{\\'has-error\\': formIntroVideo[\\'name\\' + ($index+1)].$dirty && formIntroVideo[\\'name\\' + ($index+1)].$invalid}\\\"><label for=formIntroVideo-subUnitCod{{$index+1}}>Sottotitolo</label><input ng-model=tabTheory.model.theory_subtitle name=\\\"\\\" type=text class=form-control placeholder=\\\"Inserisci il sottotitolo\\\" required> <span ng-show=\\\"formIntroVideo[\\'name\\' + ($index+1)].$dirty\\\" ng-messages=\\\"formIntroVideo[\\'name\\' + ($index+1)].$error\\\" class=help-block role=alert><span ng-message=required>Questo campo  obbligatorio</span></span></div></div><div class=separator></div><div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"\\\"><label>Testo</label><ckeditor-color model=tabTheory.model.theory_text></ckeditor-color></div></div><div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"\\\"><label>Tip Teoria</label><ckeditor-color model=tabTheory.model.theory_text_tips></ckeditor-color><div class=separator></div><a ngf-select=tabTheory.uploadImageTipFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=tabTheory.model.image_tip_theory><label><i class=\\\"fa fa-upload\\\"></i> Carica Immagine del Tip</label></a><div ng-if=\\\"tabTheory.model.theory_text_tips_image_url && !tabTheory.model.image_tip_theory.name\\\" class=url-video-box><span>Immagine: </span><a href={{tabTheory.model.theory_text_tips_image_url}} target=_blank>{{tabTheory.model.theory_text_tips_image_filename}}</a><br></div><div ng-if=tabTheory.model.image_tip_theory.name class=url-video-box><span>Immagine: </span>{{tabTheory.model.image_tip_theory.name}}<br></div></div></div>\");\n$templateCache.put(\"app/components/tabTheoryInDepth/tabTheoryInDepth.html\",\"<div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"\\\"><label>Titolo</label><input ng-model=model.theory_in_depth_title name=\\\"\\\" type=text class=form-control placeholder=\\\"Inserisci il titolo\\\"></div></div><div class=col-sm-6><div class=form-group><label>Sottotitolo</label><input ng-model=model.theory_in_depth_subtitle name=\\\"\\\" type=text class=form-control placeholder=\\\"Inserisci il sottotitolo\\\"></div></div><div class=col-sm-6><div class=\\\"form-group has-feedback\\\" ng-class=\\\"\\\"><label>Testo</label><ckeditor-color model=model.theory_in_depth_text></ckeditor-color></div></div>\");\n$templateCache.put(\"app/components/tabVideo/tabVideo.html\",\"<div class=col-sm-6><div class=form-group><label for=\\\"\\\">Titolo Video</label><input ng-model=tabVideo.model.video_title name=video_title type=text class=form-control placeholder=\\\"Inserisci il titolo del video\\\"></div></div><div class=col-sm-6><div class=form-group><label>Sottotitolo Video</label><input ng-model=tabVideo.model.video_subtitle name=video_subtitle type=text class=form-control placeholder=\\\"Inserisci il sottotitolo del video\\\"></div></div><div class=col-sm-6><a ngf-select=tabVideo.uploadVideoFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=tabVideo.model.video><label><i class=\\\"fa fa-upload\\\"></i> Carica video</label></a><div ng-if=\\\"tabVideo.model.video_url && !tabVideo.model.video.name\\\" class=url-video-box><span>Video: </span><a href={{tabVideo.model.video_url}} target=_blank>{{tabVideo.model.video_filename}}</a><br></div><div ng-if=tabVideo.model.video.name class=url-video-box><span>Video: </span>{{tabVideo.model.video.name}}</div></div><div class=col-sm-6><label for=\\\"\\\">Tip Video</label><br><ckeditor-color model=tabVideo.model.video_tips></ckeditor-color><div class=separator></div><a ngf-select=tabVideo.uploadImageTipFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=tabVideo.model.image_tip><label><i class=\\\"fa fa-upload\\\"></i> Carica Immagine del Tip</label></a><div ng-if=\\\"tabVideo.model.video_tips_image_url && !tabVideo.model.image_tip.name\\\" class=url-video-box><span>Immagine: </span><a href={{tabVideo.model.video_tips_image_url}} target=_blank>{{tabVideo.model.video_tips_image_filename}}</a><br></div><div ng-if=tabVideo.model.image_tip.name class=url-video-box><span>Immagine: </span>{{tabVideo.model.image_tip.name}}<br></div></div>\");\n$templateCache.put(\"app/components/toggleSwitch/toggleSwitch.html\",\"<div class=toggle-switch><span class=title-pubblica>Pubblica:</span><div class=switch><input type=radio class=switch-input name=view value=true id=yes ng-checked=toggleSwitch.model.published ng-model=toggleSwitch.switch ng-init=\\\"toggleSwitch.switch = toggleSwitch.model.published\\\" ng-click=\\\"toggleSwitch.publish(); $event.preventDefault();\\\"><label for=yes class=\\\"switch-label switch-label-off\\\">Si</label><input type=radio class=switch-input name=view value=false id=no ng-checked=!toggleSwitch.model.published ng-model=toggleSwitch.switch ng-init=\\\"toggleSwitch.switch = toggleSwitch.model.published\\\" ng-click=\\\"toggleSwitch.unpublish(); $event.preventDefault();\\\"><label for=no class=\\\"switch-label switch-label-on\\\">No</label><span class=switch-selection></span></div></div>\");\n$templateCache.put(\"app/components/uploadFile/uploadFile.html\",\"<input name=file type=file ng-model=model.video_url class=input-file>\");\n$templateCache.put(\"app/pages/admin/admin.html\",\"<div class=wrapper><galore-header></galore-header><galore-sidebar></galore-sidebar><galore-uploader></galore-uploader><div class=content-wrapper><div ui-view></div></div><galore-footer></galore-footer></div>\");\n$templateCache.put(\"app/pages/createUnit/createUnit.html\",\"<section class=create-unit><section class=content-header><h1>Aggiungi unit</h1></section><section class=content><section-a></section-a><section-b></section-b><section-c></section-c><section-d></section-d><section-e></section-e></section></section>\");\n$templateCache.put(\"app/pages/dashboard/dashboard.html\",\"<div class=\\\"content events\\\"><div class=row><div class=col-xs-12><div class=\\\"box box-default\\\"><div class=box-header><div class=box-title>Dashboard</div></div></div><!-- /.box --></div></div></div>\");\n$templateCache.put(\"app/pages/faq/faq.html\",\"<section class=unit><section class=content-header><h1>Faq</h1></section><section class=content></section></section>\");\n$templateCache.put(\"app/pages/login/login.html\",\"<div class=\\\"login login-box\\\"><div class=login-logo><img src=/assets/images/logo-login.png alt=\\\"English Galore\\\"></div><!-- /.login-logo --><div class=login-box-body><p class=login-box-msg>Sign in to start your session</p><form id=loginForm name=loginForm ng-submit=vm.login()><div class=\\\"form-group has-feedback\\\" ng-class=\\\"{\\'has-error\\': loginForm.email.$dirty && loginForm.email.$invalid}\\\"><input ng-model=vm.user.email name=email type=email class=form-control placeholder=Email required> <span class=\\\"glyphicon glyphicon-envelope form-control-feedback\\\"></span> <span ng-show=loginForm.email.$dirty ng-messages=loginForm.email.$error class=help-block role=alert><span ng-message=required>Questo campo  obbligatorio</span> <span ng-message=email>Inserire un indirizzo email valido</span></span></div><div class=\\\"form-group has-feedback\\\" ng-class=\\\"{\\'has-error\\': loginForm.password.$dirty && loginForm.password.$invalid}\\\"><input ng-model=vm.user.password name=password type=password class=form-control placeholder=Password required> <span class=\\\"glyphicon glyphicon-lock form-control-feedback\\\"></span> <span ng-show=loginForm.password.$dirty ng-messages=loginForm.password.$error class=help-block role=alert><span ng-message=required>Questo campo  obbligatorio</span></span></div><div class=row><!-- /.col --><div class=col-xs-12><button ng-disabled=loginForm.$invalid type=submit class=\\\"btn btn-success btn-block btn-flat\\\">Sign In</button></div><!-- /.col --></div></form></div><!-- /.login-box-body --></div>\");\n$templateCache.put(\"app/pages/main/main.html\",\"<div class=animate ui-view></div>\");\n$templateCache.put(\"app/pages/unit/unit.html\",\"<section class=unit><section class=content-header><h1>{{vm.models.current_unit.title}} <span ng-if=!vm.models.current_unit.published class=title-bozza>- Bozza</span> <span ng-if=vm.models.current_unit.published class=title-pubblicata>- Pubblicata</span></h1><div class=pull-right><toggle-switch model=vm.models.current_unit></toggle-switch></div></section><section class=content><section-unit unit=vm.models.current_unit></section-unit><section-a section=vm.models.current_unit_section_a></section-a><section-b section=vm.models.current_unit_section_b></section-b><section-c section=vm.models.current_unit_section_c></section-c><section-d section=vm.models.current_unit_section_d></section-d><section-e section=vm.models.current_unit_section_e></section-e></section></section>\");\n$templateCache.put(\"app/pages/profile/profile.html\",\"<div class=profile><section class=content-header><h1>Gestione Profilo</h1></section></div>\");\n$templateCache.put(\"app/components/exercise/destroy/destroy.html\",\"<div class=modal-header><a role=button class=close ng-click=unitDestroy.cancel()><span aria-hidden=true></span></a><h3 class=modal-title>Sei sicuro?</h3></div><div class=modal-body>Questa operazione <strong>non  reversibile</strong>.</div><div class=modal-footer><a role=button class=\\\"btn btn-blue pull-left\\\" ng-click=exerciseDestroy.cancel()>Annulla</a> <a role=button class=\\\"btn btn-success btn-red\\\" ng-click=exerciseDestroy.ok()>Elimina esercizio</a></div>\");\n$templateCache.put(\"app/components/exercise/exerciseShow/exerciseShow.html\",\"<div class=\\\"content exercise\\\"><form ng-submit=exerciseShow.submit($event) ng-model=exerciseShow.form><div class=row><div class=col-sm-6><div class=form-group><input type=hidden ng-init=\\\"exerciseShow.form.id = exerciseShow.model.id\\\" ng-model=exerciseShow.form.id><label>Numero Esercizio</label><select ng-init=\\\"exerciseShow.form.exercise_number = exerciseShow.model.exercise_number\\\" ng-model=exerciseShow.form.exercise_number class=form-control ng-options=\\\"n for n in [] | range:1:6\\\" required></select></div></div><div class=col-sm-6><div class=form-group><label>Tipologia Esercizio</label><select ng-init=\\\"exerciseShow.exercise_type_temp = {id: exerciseShow.model.exercise_type}\\\" ng-model=exerciseShow.exercise_type_temp class=form-control ng-options=\\\"option.name for option in exerciseShow.data.availableOptions track by option.id\\\" required></select></div></div><div class=col-sm-6><div class=form-group ng-class=\\\"\\\"><label>Titolo Esercizio</label><input ng-init=\\\"exerciseShow.form.title = exerciseShow.model.title\\\" ng-model=exerciseShow.form.title type=text class=form-control placeholder=\\\"Inserisci il titolo dell\\'esercizio\\\" required></div></div><div class=col-sm-6><div class=form-group ng-class=\\\"\\\"><label>Sottotitolo Esercizio</label><input ng-init=\\\"exerciseShow.form.subtitle = exerciseShow.model.subtitle\\\" ng-model=exerciseShow.form.subtitle type=text class=form-control placeholder=\\\"Inserisci il sottotitolo dell\\'esercizio\\\" required></div></div></div><div class=row><div class=col-sm-6><div class=form-group ng-init=\\\"exerciseShow.form.exercise_tips = exerciseShow.model.exercise_tips\\\"><label for=\\\"\\\">Tip Esercizio</label><ckeditor-color model=exerciseShow.form.exercise_tips></ckeditor-color><div class=separator></div><a ngf-select=exerciseShow.uploadImageTipFile($file) ngf-multiple=false ngf-allow-dir=false class=upload-video-label instance=exerciseShow.form.image_tip><label><i class=\\\"fa fa-upload\\\"></i> Carica Immagine del Tip</label></a><div ng-if=\\\"exerciseShow.model.exercise_tips_image_url && !exerciseShow.form.image_tip.name\\\" class=url-video-box><span>Immagine: </span><a href={{exerciseShow.model.exercise_tips_image_url}} target=_blank>{{exerciseShow.model.exercise_tips_image_filename}}</a><br></div><div ng-if=exerciseShow.form.image_tip.name class=url-video-box><span>Immagine: </span>{{exerciseShow.form.image_tip.name}}<br></div></div></div><div class=col-sm-6 ng-if=\\\"(exerciseShow.exercise_type_temp.id > 0 && exerciseShow.exercise_type_temp.id < 6) || exerciseShow.exercise_type_temp.id === 8\\\"><div class=form-group ng-init=\\\"exerciseShow.form.exercise_text = exerciseShow.model.exercise_text\\\"><label for=\\\"\\\">Testo Esercizio</label><ckeditor-color model=exerciseShow.form.exercise_text></ckeditor-color></div></div></div><div class=separator></div><div class=row ng-if=\\\"exerciseShow.exercise_type_temp.id === 6 || exerciseShow.exercise_type_temp.id === 9\\\"><exercise-image-text idex=exerciseShow.model.id model=exerciseShow.form.exercise_image_text_items ng-init=\\\"exerciseShow.form.exercise_image_text_items = exerciseShow.model.exercise_image_text_items\\\"></exercise-image-text></div><div class=row ng-if=\\\"exerciseShow.exercise_type_temp.id === 7\\\"><exercise-text-text idex=exerciseShow.model.id model=exerciseShow.exercise_text_text_items ng-init=\\\"exerciseShow.exercise_text_text_items = exerciseShow.model.exercise_text_text_items\\\"></exercise-text-text></div><div class=separator></div><div class=row><div class=col-sm-12><input type=submit class=\\\"btn btn-success pull-right btn-blue\\\" value=\\\"Salva Esercizio\\\"> <input type=button ng-click=exerciseShow.destroy(exerciseShow.form.id) class=\\\"btn btn-success pull-right btn-red\\\" value=\\\"Elimina Esercizio\\\"></div></div><div ng-show=exerciseShow.loading class=\\\"overlay absolute fill\\\"><i class=\\\"fa fa-refresh fa-spin\\\"></i></div></form></div>\");\n$templateCache.put(\"app/pages/faq/category/category.html\",\"<section class=unit><section class=content-header><h1>Categorie</h1></section><section class=content><div><!--     <table class=\\\"table table-responsive\\\">\\n        <tbody>\\n          <tr>\\n            <th>Ordine</th>\\n            <th>Categoria</th>\\n          </tr>\\n          <tr>\\n            <td width=\\\"80px\\\">\\n              <div class=\\\"form-group\\\">\\n                <input\\n                ng-model=\\\"exerciseTextText.exercise_text_text_item.item_number\\\"\\n                name=\\\"item_number\\\"\\n                type=\\\"number\\\"\\n                class=\\\"form-control\\\"\\n                >\\n              </div>\\n            </td>\\n          </tr>\\n        </tbody>\\n      </table> --></div></section></section>\");\n$templateCache.put(\"app/pages/unit/destroy/destroy.html\",\"<div class=modal-header><a role=button class=close ng-click=unitDestroy.cancel()><span aria-hidden=true></span></a><h3 class=modal-title>Sei sicuro?</h3></div><div class=modal-body>Se elimini questa unit, verranno eliminate anche tutte le sezioni associate.<br>Questa operazione <strong>non  reversibile</strong>.</div><div class=modal-footer><a role=button class=\\\"btn btn-blue pull-left\\\" ng-click=unitDestroy.cancel()>Annulla</a> <a role=button class=\\\"btn btn-success btn-red\\\" ng-click=unitDestroy.ok()>Elimina unit</a></div>\");}]);"],"sourceRoot":"/source/"}